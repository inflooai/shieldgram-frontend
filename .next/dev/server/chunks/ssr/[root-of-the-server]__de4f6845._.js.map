{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/cauldronpumpkin/Documents/infloo/shieldgram-frontend/types.ts"],"sourcesContent":["export enum CommentRiskLevel {\n  SAFE = 'SAFE',\n  SPAM = 'SPAM',\n  TOXIC = 'TOXIC',\n  INAPPROPRIATE = 'INAPPROPRIATE',\n  HATE_SPEECH = 'HATE_SPEECH',\n  SEXUAL = 'SEXUAL',\n  RACISM = 'RACISM',\n  HARASSMENT = 'HARASSMENT',\n  VIOLENCE = 'VIOLENCE',\n  SELF_HARM = 'SELF_HARM',\n  PROFANITY = 'PROFANITY',\n  NEGATIVITY = 'NEGATIVITY'\n}\n\nexport interface ModerationResult {\n  riskLevel: CommentRiskLevel;\n  confidenceScore: number;\n  explanation: string;\n  suggestedAction: 'APPROVE' | 'HIDE';\n}\n\nexport interface DemoComment {\n  id: string;\n  author: string;\n  text: string;\n  avatarUrl: string;\n  timestamp: string;\n}\n\nexport type PolicyType = 'Profanity' | 'Sexual Content' | 'Hate speech' | 'Self harm' | 'Violence' | 'Negativity' | 'Harassment' | 'Spam' | 'General';\n\nexport interface DashboardStat {\n  label: string;\n  value: string | number;\n  change?: string;\n  trend?: 'up' | 'down' | 'neutral';\n}\n\nexport interface ModeratedCommentLog {\n  id: string;\n  author: string;\n  text: string;\n  riskLevel: CommentRiskLevel;\n  timestamp: string;\n  actionTaken: string;\n  commenter_id?: string;\n}"],"names":[],"mappings":";;;;AAAO,IAAA,AAAK,0CAAA;;;;;;;;;;;;;WAAA"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///Users/cauldronpumpkin/Documents/infloo/shieldgram-frontend/utils/auth.ts"],"sourcesContent":["\nexport const getAuthToken = (): string | null => {\n  return getCookie('user-access-token');\n};\n\nconst getCookie = (name: string): string | null => {\n  if (typeof document === 'undefined') return null;\n  const match = document.cookie.match(new RegExp('(^| )' + name + '=([^;]+)'));\n  return match ? match[2] : null;\n};\n\nexport const setAuthTokens = (tokens: { accessToken: string; idToken: string; refreshToken?: string }) => {\n  if (typeof window === 'undefined') return;\n  const hostname = window.location.hostname;\n  const isLocalhost = hostname === 'localhost' || hostname.endsWith('.localhost') || hostname.includes('127.0.0.1');\n  \n  let domainAttribute = '';\n  if (!isLocalhost) {\n    const rootDomain = hostname.replace(/^(dashboard|www)\\./, '');\n    domainAttribute = `; domain=.${rootDomain}`;\n  }\n\n  const baseFlags = `; path=/; max-age=604800${domainAttribute}; SameSite=Lax; Secure`;\n\n  // Store Access Token\n  document.cookie = `user-access-token=${tokens.accessToken}${baseFlags}`;\n  \n  // Store ID Token\n  document.cookie = `user-id-token=${tokens.idToken}${baseFlags}`;\n\n  // Store Refresh Token if provided\n  if (tokens.refreshToken) {\n    document.cookie = `user-refresh-token=${tokens.refreshToken}${baseFlags}`;\n  }\n};\n\nexport const getAuthTokens = () => {\n  return {\n    accessToken: getCookie('user-access-token'),\n    idToken: getCookie('user-id-token'),\n    refreshToken: getCookie('user-refresh-token'),\n  };\n};\n\nexport const setAuthToken = (token: string) => {\n  setAuthTokens({ accessToken: token, idToken: token }); // Fallback for single-token calls\n};\n\nexport const removeAuthToken = () => {\n  if (typeof window === 'undefined') return;\n  const hostname = window.location.hostname;\n  const isLocalhost = hostname === 'localhost' || hostname.endsWith('.localhost') || hostname.includes('127.0.0.1');\n\n  let domainAttribute = '';\n  if (!isLocalhost) {\n    const rootDomain = hostname.replace(/^(dashboard|www)\\./, '');\n    domainAttribute = `; domain=.${rootDomain}`;\n  }\n  \n  const expireFlags = `; path=/; max-age=0${domainAttribute}; SameSite=Lax; Secure`;\n  \n  document.cookie = `user-access-token=${expireFlags}`;\n  document.cookie = `user-id-token=${expireFlags}`;\n  document.cookie = `user-refresh-token=${expireFlags}`;\n  document.cookie = `user-token=${expireFlags}`; // Cleanup legacy cookie\n};\n\nexport const setThemeCookie = (theme: 'light' | 'dark') => {\n  const hostname = window.location.hostname;\n  const isLocalhost = hostname === 'localhost' || hostname.endsWith('.localhost') || hostname.includes('127.0.0.1');\n\n  let domainAttribute = '';\n  if (!isLocalhost) {\n    const rootDomain = hostname.replace(/^(dashboard|www)\\./, '');\n    domainAttribute = `; domain=.${rootDomain}`;\n  }\n\n  // Set theme cookie for 1 year\n  document.cookie = `sg-theme=${theme}; path=/; max-age=31536000${domainAttribute}; SameSite=Lax; Secure`;\n};\n\nexport const getThemeCookie = (): 'light' | 'dark' | null => {\n  return getCookie('sg-theme') as 'light' | 'dark' | null;\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AACO,MAAM,eAAe;IAC1B,OAAO,UAAU;AACnB;AAEA,MAAM,YAAY,CAAC;IACjB,IAAI,OAAO,aAAa,aAAa,OAAO;IAC5C,MAAM,QAAQ,SAAS,MAAM,CAAC,KAAK,CAAC,IAAI,OAAO,UAAU,OAAO;IAChE,OAAO,QAAQ,KAAK,CAAC,EAAE,GAAG;AAC5B;AAEO,MAAM,gBAAgB,CAAC;IAC5B,wCAAmC;;;IACnC,MAAM;IACN,MAAM;IAEN,IAAI;IAMJ,MAAM;AAYR;AAEO,MAAM,gBAAgB;IAC3B,OAAO;QACL,aAAa,UAAU;QACvB,SAAS,UAAU;QACnB,cAAc,UAAU;IAC1B;AACF;AAEO,MAAM,eAAe,CAAC;IAC3B,cAAc;QAAE,aAAa;QAAO,SAAS;IAAM,IAAI,kCAAkC;AAC3F;AAEO,MAAM,kBAAkB;IAC7B,wCAAmC;;;IACnC,MAAM;IACN,MAAM;IAEN,IAAI;IAMJ,MAAM;AAMR;AAEO,MAAM,iBAAiB,CAAC;IAC7B,MAAM,WAAW,OAAO,QAAQ,CAAC,QAAQ;IACzC,MAAM,cAAc,aAAa,eAAe,SAAS,QAAQ,CAAC,iBAAiB,SAAS,QAAQ,CAAC;IAErG,IAAI,kBAAkB;IACtB,IAAI,CAAC,aAAa;QAChB,MAAM,aAAa,SAAS,OAAO,CAAC,sBAAsB;QAC1D,kBAAkB,CAAC,UAAU,EAAE,YAAY;IAC7C;IAEA,8BAA8B;IAC9B,SAAS,MAAM,GAAG,CAAC,SAAS,EAAE,MAAM,0BAA0B,EAAE,gBAAgB,sBAAsB,CAAC;AACzG;AAEO,MAAM,iBAAiB;IAC5B,OAAO,UAAU;AACnB"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///Users/cauldronpumpkin/Documents/infloo/shieldgram-frontend/services/dashboardService.ts"],"sourcesContent":["import { PolicyType } from \"../types\";\n// @ts-ignore\nimport { CognitoUserPool, CognitoUser, CognitoIdToken, CognitoAccessToken, CognitoRefreshToken, CognitoUserSession } from 'amazon-cognito-identity-js';\nimport { getAuthTokens, setAuthTokens, removeAuthToken } from '../utils/auth';\n\nconst COGNITO_CONFIG = {\n  UserPoolId: process.env.NEXT_PUBLIC_COGNITO_USER_POOL_ID, \n  ClientId: process.env.NEXT_PUBLIC_COGNITO_CLIENT_ID\n};\n\nconst base = process.env.NEXT_PUBLIC_DASHBOARD_API_URL || \"\";\nconst DASHBOARD_API_URL = base.endsWith('/') ? base.slice(0, -1) : base;\n\nconst pgBase = process.env.LAMBDA_URL || process.env.NEXT_PUBLIC_LAMBDA_URL || \"\";\nconst PLAYGROUND_API_URL = pgBase.endsWith('/') ? pgBase.slice(0, -1) : pgBase;\n\nexport interface AccountInfo {\n  account_id: string;\n  account_name: string;\n  owner_user_id: string;\n  plan_type: string;\n  policies: string;\n  custom_policy: string;\n  confidence_threshold: number;\n  profile_picture_url: string;\n  custom_policy_definitions?: { policy_name: string, description: string }[];\n  is_deauthorized?: boolean;\n  stats?: {\n    comments_scanned: number;\n    comments_moderated: number;\n    processing_time?: number;\n  };\n}\n\n\nexport interface DashboardData {\n  accounts: AccountInfo[];\n  plan_type: string;\n}\n\n/**\n * Ensures a valid session is available. Refreshes if access token is expired.\n */\nexport const getValidToken = async (): Promise<string> => {\n  const { idToken, accessToken, refreshToken } = getAuthTokens();\n  \n  if (!idToken || !accessToken || !refreshToken) {\n    throw new Error(\"No session found\");\n  }\n\n  // If we are in mock mode, just return the dummy token\n  if (!COGNITO_CONFIG.UserPoolId || COGNITO_CONFIG.UserPoolId.includes('xxx')) {\n    return accessToken;\n  }\n\n  const userPool = new CognitoUserPool({\n    UserPoolId: COGNITO_CONFIG.UserPoolId,\n    ClientId: COGNITO_CONFIG.ClientId,\n  });\n\n  // Reconstruct session\n  const cognitoIdToken = new CognitoIdToken({ IdToken: idToken });\n  const cognitoAccessToken = new CognitoAccessToken({ AccessToken: accessToken });\n  const cognitoRefreshToken = new CognitoRefreshToken({ RefreshToken: refreshToken });\n  \n  const session = new CognitoUserSession({\n    IdToken: cognitoIdToken,\n    AccessToken: cognitoAccessToken,\n    RefreshToken: cognitoRefreshToken,\n  });\n\n  if (session.isValid()) {\n    return accessToken;\n  }\n\n  // Session expired, attempt refresh\n  console.log(\"Session expired, refreshing...\");\n  const user = new CognitoUser({\n    Username: cognitoIdToken.decodePayload().email || \"\",\n    Pool: userPool\n  });\n\n  return new Promise((resolve, reject) => {\n    user.refreshSession(cognitoRefreshToken, (err: any, newSession: any) => {\n      if (err) {\n        console.error(\"Failed to refresh session\", err);\n        removeAuthToken(); // Logout on hard failure\n        reject(err);\n        return;\n      }\n      \n      const newTokens = {\n        accessToken: newSession.getAccessToken().getJwtToken(),\n        idToken: newSession.getIdToken().getJwtToken(),\n        refreshToken: newSession.getRefreshToken().getToken()\n      };\n      \n      setAuthTokens(newTokens);\n      resolve(newTokens.accessToken);\n    });\n  });\n};\n\n/**\n * Gets a CognitoUser instance with an active session attached.\n */\nconst getCognitoUser = async (): Promise<CognitoUser> => {\n  const { idToken, accessToken, refreshToken } = getAuthTokens();\n  if (!idToken || !accessToken || !refreshToken) throw new Error(\"No session found\");\n\n  const userPool = new CognitoUserPool({\n    UserPoolId: COGNITO_CONFIG.UserPoolId,\n    ClientId: COGNITO_CONFIG.ClientId,\n  });\n\n  const cognitoIdToken = new CognitoIdToken({ IdToken: idToken });\n  const cognitoAccessToken = new CognitoAccessToken({ AccessToken: accessToken });\n  const cognitoRefreshToken = new CognitoRefreshToken({ RefreshToken: refreshToken });\n\n  const session = new CognitoUserSession({\n    IdToken: cognitoIdToken,\n    AccessToken: cognitoAccessToken,\n    RefreshToken: cognitoRefreshToken,\n  });\n\n  const user = new CognitoUser({\n    Username: cognitoIdToken.decodePayload().email || \"\",\n    Pool: userPool\n  });\n\n  // IMPORTANT: Attach the session to the user\n  user.setSignInUserSession(session);\n\n  return user;\n};\n\nexport const initiateMFASetup = async (): Promise<string> => {\n  const user = await getCognitoUser();\n  await getValidToken(); // Ensure session is active\n\n  return new Promise((resolve, reject) => {\n    user.associateSoftwareToken({\n      associateSecretCode: (secretCode: string) => {\n        resolve(secretCode);\n      },\n      onFailure: (err: any) => {\n        reject(err);\n      }\n    });\n  });\n};\n\nexport const finalizeMFASetup = async (code: string): Promise<void> => {\n  const user = await getCognitoUser();\n  await getValidToken();\n\n  return new Promise((resolve, reject) => {\n    user.verifySoftwareToken(code, 'ShieldGram', {\n      onSuccess: (session: any) => {\n        console.log(\"TOTP verified successfully\", session);\n        // After verifying, set TOTP as the preferred MFA method\n        user.setUserMfaPreference(\n          null, // SMS settings (null = no change)\n          { PreferredMfa: true, Enabled: true }, // TOTP settings\n          (err: any, result: any) => {\n            if (err) {\n              console.error(\"Failed to set MFA preference\", err);\n              reject(err);\n            } else {\n              console.log(\"MFA preference set successfully\", result);\n              resolve();\n            }\n          }\n        );\n      },\n      onFailure: (err: any) => {\n        console.error(\"TOTP verification failed\", err);\n        reject(err);\n      }\n    });\n  });\n};\n\nexport const disableMFA = async (): Promise<void> => {\n  const user = await getCognitoUser();\n  await getValidToken();\n\n  return new Promise((resolve, reject) => {\n    user.setUserMfaPreference(null, {\n      PreferredMfa: false,\n      Enabled: false\n    }, (err: any) => {\n      if (err) reject(err);\n      else resolve();\n    });\n  });\n};\n\nexport const getMFAStatus = async (): Promise<boolean> => {\n  const user = await getCognitoUser();\n  await getValidToken();\n\n  return new Promise((resolve) => {\n    user.getUserData((err: any, data: any) => {\n      if (err) {\n        resolve(false);\n        return;\n      }\n      const mfaSetting = data.UserMFASettingList || [];\n      const preferredMFA = data.PreferredMfaSetting;\n      resolve(mfaSetting.includes('SOFTWARE_TOKEN_MFA') || preferredMFA === 'SOFTWARE_TOKEN_MFA');\n    }, { bypassCache: true }); // Always check fresh status\n  });\n};\n\nexport const getDashboardInfo = async (): Promise<DashboardData> => {\n  const idToken = await getValidToken();\n\n  try {\n    const response = await fetch(`${DASHBOARD_API_URL}/dashboard-info`, {\n      method: 'GET',\n      headers: {\n        'Authorization': `Bearer ${idToken}`,\n        'Content-Type': 'application/json',\n      },\n    });\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      const apiError = new Error(errorData.error || `API error: ${response.status}`) as any;\n      apiError.status = response.status;\n      throw apiError;\n    }\n\n    const data = await response.json();\n    return {\n      accounts: data.accounts || [],\n      plan_type: data.plan_type || 'standard'\n    };\n  } catch (error) {\n    console.error(\"Error fetching dashboard info:\", error);\n    throw error;\n  }\n};\n\nexport const saveDashboardControls = async (\n  account_id: string,\n  owner_user_id: string,\n  policies: string,\n  plan_type: string,\n  custom_policy: string,\n  confidence_threshold: number\n): Promise<void> => {\n  const idToken = await getValidToken();\n  try {\n    const response = await fetch(`${DASHBOARD_API_URL}/save-controls`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${idToken}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        account_id,\n        owner_user_id,\n        policies,\n        plan_type,\n        custom_policy,\n        confidence_threshold\n      }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      const apiError = new Error(errorData.error || `API error: ${response.status}`) as any;\n      apiError.status = response.status;\n      throw apiError;\n    }\n  } catch (error) {\n    console.error(\"Error saving dashboard controls:\", error);\n    throw error;\n  }\n};\n\nexport const addInstagramAccount = async (code: string): Promise<any> => {\n  const idToken = await getValidToken();\n  try {\n    const response = await fetch(`${DASHBOARD_API_URL}/add-account`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${idToken}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ code }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      const apiError = new Error(errorData.error || `API error: ${response.status}`) as any;\n      apiError.status = response.status;\n      throw apiError;\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error(\"Error adding Instagram account:\", error);\n    throw error;\n  }\n};\n\nexport const getInterventions = async (account_id: string, limit: number = 10): Promise<any[]> => {\n  const idToken = await getValidToken();\n  try {\n    const response = await fetch(`${DASHBOARD_API_URL}/interventions?account_id=${account_id}&limit=${limit}`, {\n      method: 'GET',\n      headers: {\n        'Authorization': `Bearer ${idToken}`,\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      const apiError = new Error(errorData.error || `API error: ${response.status}`) as any;\n      apiError.status = response.status;\n      throw apiError;\n    }\n\n    const data = await response.json();\n    return data.interventions || [];\n  } catch (error) {\n    throw error;\n  }\n};\n\nexport const saveCustomPolicy = async (\n  account_id: string,\n  policy_name: string,\n  description: string\n): Promise<void> => {\n  const idToken = await getValidToken();\n  try {\n    const response = await fetch(`${DASHBOARD_API_URL}/save-custom-policy`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${idToken}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        account_id,\n        policy_name,\n        description\n      }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      const apiError = new Error(errorData.error || `API error: ${response.status}`) as any;\n      apiError.status = response.status;\n      throw apiError;\n    }\n  } catch (error) {\n    console.error(\"Error saving custom policy:\", error);\n    throw error;\n  }\n};\n\nexport const deleteCustomPolicy = async (\n  account_id: string,\n  policy_name: string\n): Promise<void> => {\n  const idToken = await getValidToken();\n  try {\n    const response = await fetch(`${DASHBOARD_API_URL}/delete-custom-policy`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${idToken}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        account_id,\n        policy_name\n      }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      const apiError = new Error(errorData.error || `API error: ${response.status}`) as any;\n      apiError.status = response.status;\n      throw apiError;\n    }\n  } catch (error) {\n    console.error(\"Error deleting custom policy:\", error);\n    throw error;\n  }\n};\n\nexport const removeInstagramAccount = async (account_id: string): Promise<void> => {\n  const idToken = await getValidToken();\n  try {\n    const response = await fetch(`${DASHBOARD_API_URL}/dashboard-info?account_id=${account_id}`, {\n      method: 'DELETE',\n      headers: {\n        'Authorization': `Bearer ${idToken}`,\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      const apiError = new Error(errorData.error || `API error: ${response.status}`) as any;\n      apiError.status = response.status;\n      throw apiError;\n    }\n  } catch (error) {\n    console.error(\"Error removing Instagram account:\", error);\n    throw error;\n  }\n};\n\nexport const processIntervention = async (\n  account_id: string,\n  comment_id: string | null,\n  commenter_id: string | null,\n  action: 'HIDE' | 'DELETE' | 'RESTRICT' | 'SAFE',\n  action_type: 'COMMENT' | 'USER' = 'COMMENT'\n): Promise<void> => {\n  const idToken = await getValidToken();\n  try {\n    const response = await fetch(`${DASHBOARD_API_URL}/intervene`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${idToken}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        account_id,\n        comment_id,\n        commenter_id,\n        action,\n        action_type\n      }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      const apiError = new Error(errorData.error || `API error: ${response.status}`) as any;\n      apiError.status = response.status;\n      throw apiError;\n    }\n  } catch (error) {\n    console.error(\"Error processing intervention:\", error);\n    throw error;\n  }\n};\n\nexport const getPlans = async (): Promise<any[]> => {\n  let idToken = null;\n  try {\n     idToken = await getValidToken();\n  } catch (e) {\n     // Ignore token error for public route\n  }\n\n  try {\n    const headers: Record<string, string> = {\n      'Content-Type': 'application/json',\n    };\n    if (idToken) {\n      headers['Authorization'] = `Bearer ${idToken}`;\n    }\n\n    const response = await fetch(`${PLAYGROUND_API_URL}/plans`, {\n      method: 'GET',\n      headers: headers,\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      const apiError = new Error(errorData.error || `API error: ${response.status}`) as any;\n      apiError.status = response.status;\n      throw apiError;\n    }\n\n    const data = await response.json();\n    return data.plans || [];\n  } catch (error) {\n    console.error(\"Error fetching plans:\", error);\n    return [];\n  }\n};\n\nexport const createSubscription = async (plan_id: string): Promise<string | null> => {\n  const idToken = await getValidToken();\n  try {\n    const response = await fetch(`${DASHBOARD_API_URL}/create-subscription`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${idToken}`,\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ plan_id })\n    });\n\n    if (!response.ok) {\n      console.error(\"Failed to create subscription:\", response.status);\n      return null;\n    }\n\n    const data = await response.json();\n    return data.subscription_id || null;\n  } catch (error) {\n    console.error(\"Error creating subscription:\", error);\n    return null;\n  }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 624, "column": 0}, "map": {"version":3,"sources":["file:///Users/cauldronpumpkin/Documents/infloo/shieldgram-frontend/components/Dashboard.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { \n  BarChart3, ShieldCheck, ShieldAlert, Trash2, CheckCircle, Ban, \n  Shield, LogOut, Sun, Moon, LayoutDashboard, Sliders, Lock, Save, \n  Check, RefreshCw, CreditCard, Download, Zap, ChevronDown, Plus,\n  AlertCircle, Target, Edit2, Loader2, HelpCircle\n} from 'lucide-react';\nimport { ModeratedCommentLog, CommentRiskLevel } from '../types';\n// import SEO from './SEO';\n// import logo from \"../logo.svg\";\n\nimport { getAuthTokens, removeAuthToken } from '../utils/auth';\nimport { \n  getDashboardInfo, \n  saveDashboardControls, \n  addInstagramAccount, \n  getInterventions, \n  AccountInfo,\n  saveCustomPolicy as saveCustomPolicyApi,\n  deleteCustomPolicy as deleteCustomPolicyApi,\n  processIntervention,\n  removeInstagramAccount,\n  initiateMFASetup,\n  finalizeMFASetup,\n  disableMFA,\n  getMFAStatus,\n  getPlans,\n  createSubscription\n} from '../services/dashboardService';\n\ninterface DashboardProps {\n  onLogout?: () => void;\n  isDarkMode?: boolean;\n  toggleTheme?: () => void;\n}\n\n\ntype Tab = 'overview' | 'controls' | 'plan' | 'security';\ntype PlanType = 'standard' | 'plus' | 'pro' | 'max' | '';\n\ninterface DashboardStats {\n  scanned: number;\n  moderated: number;\n  averageResponseTime: number;\n}\n\ninterface UserSettings {\n  plan: PlanType;\n  policies: {\n    profanity: boolean;\n    sexualContent: boolean;\n    hateSpeech: boolean;\n    selfHarm: boolean;\n    violence: boolean;\n    negativity: boolean;\n    harassment: boolean;\n    spam: boolean;\n  };\n  customInstructions: string;\n  confidenceThreshold: number;\n  selectedCustomPolicies: string[];\n  customPolicyDescriptions: Record<string, string>; // policy_name -> description\n}\n\ninterface Account {\n  id: string;\n  name: string;\n  handle: string;\n  profilePictureUrl?: string;\n  isDeauthorized?: boolean;\n}\n\nconst MOCK_ACCOUNTS: Account[] = [];\n\n\n// Plan definitions for the billing tab\nconst PLANS = {\n  standard: { price: 5, label: 'Standard', features: ['5k comments/mo', '1 social account', 'Standard Protection'] },\n  plus: { price: 15, label: 'Plus', features: ['20k comments/mo', '2 social accounts', 'Standard Protection'] },\n  pro: { price: 30, label: 'Pro', features: ['50k comments/mo', '5 social accounts', 'Advanced Reasoning', 'Custom Policies'] },\n  max: { price: 75, label: 'Max', features: ['200k comments/mo', 'Unlimited accounts', 'Advanced Reasoning', 'Custom Policies'] }\n};\n\n// Helper to load Razorpay SDK\nconst loadRazorpayScript = () => {\n  return new Promise((resolve) => {\n    const script = document.createElement('script');\n    script.src = 'https://checkout.razorpay.com/v1/checkout.js';\n    script.onload = () => {\n      resolve(true);\n    };\n    script.onerror = () => {\n      resolve(false);\n    };\n    document.body.appendChild(script);\n  });\n};\n\nconst Dashboard: React.FC<DashboardProps> = ({ onLogout, isDarkMode, toggleTheme }) => {\n  const [activeTab, setActiveTab] = useState<Tab>(() => {\n    const params = new URLSearchParams(window.location.search);\n    const tab = params.get('tab') as Tab;\n    return (['overview', 'controls', 'plan', 'security'] as Tab[]).includes(tab) ? tab : 'overview';\n  });\n  const [isLoading, setIsLoading] = useState(false);\n  const [isLoadingInterventions, setIsLoadingInterventions] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [notification, setNotification] = useState<{message: string, type: 'success' | 'error'} | null>(null);\n\n  const showToast = (message: string, type: 'success' | 'error' = 'success') => {\n    setNotification({ message, type });\n    setTimeout(() => setNotification(null), 3000);\n  };\n  \n  // Account State\n  const [accounts, setAccounts] = useState<Account[]>(MOCK_ACCOUNTS);\n  const [currentAccount, setCurrentAccount] = useState<Account | null>(null);\n  const [isAccountDropdownOpen, setIsAccountDropdownOpen] = useState(false);\n  \n  // MFA Setup State\n  const [mfaStatus, setMfaStatus] = useState<boolean>(false);\n  const [isMFASetupOpen, setIsMFASetupOpen] = useState(false);\n  const [mfaSecret, setMfaSecret] = useState<string | null>(null);\n  const [mfaVerificationCode, setMfaVerificationCode] = useState('');\n  const [isMFAInitLoading, setIsMFAInitLoading] = useState(false);\n  const [isMFAVerifyLoading, setIsMFAVerifyLoading] = useState(false);\n  \n  // RAW Data for current account\n  const [rawAccountInfo, setRawAccountInfo] = useState<AccountInfo | null>(null);\n\n  // Payment State\n  const [isProcessingPayment, setIsProcessingPayment] = useState(false);\n  const [currency, setCurrency] = useState<'USD' | 'INR'>('USD');\n  const [razorpayPlans, setRazorpayPlans] = useState<any[]>([]);\n\n\n  // Data States\n  const [stats, setStats] = useState<DashboardStats>({ scanned: 0, moderated: 0, averageResponseTime: 0 });\n  const [activity, setActivity] = useState<ModeratedCommentLog[]>([]);\n  const [interventionsLimit, setInterventionsLimit] = useState(10);\n  const [settings, setSettings] = useState<UserSettings>({\n    plan: '', // No plan by default\n    policies: { \n        profanity: true, \n        sexualContent: true, \n        hateSpeech: true, \n        selfHarm: false, \n        violence: false, \n        negativity: false, \n        harassment: false, \n        spam: true \n    },\n    customInstructions: '',\n    confidenceThreshold: 80,\n    selectedCustomPolicies: [],\n    customPolicyDescriptions: {}\n  });\n  const [originalSettings, setOriginalSettings] = useState<UserSettings | null>(null);\n\n  const isDirty = React.useMemo(() => {\n    if (!originalSettings) return false;\n    return JSON.stringify(settings) !== JSON.stringify(originalSettings);\n  }, [settings, originalSettings]);\n\n  const handleCancelChanges = () => {\n    if (originalSettings) {\n        setSettings(originalSettings);\n        showToast('Changes reverted', 'success');\n    }\n  };\n\n  // Custom Policy Form State\n  const [isCustomPolicyFormOpen, setIsCustomPolicyFormOpen] = useState(false);\n  const [editingPolicyName, setEditingPolicyName] = useState<string | null>(null);\n  const [newPolicyName, setNewPolicyName] = useState('');\n  const [newPolicyCondition, setNewPolicyCondition] = useState('');\n  const [newPolicyAction, setNewPolicyAction] = useState('spam');\n\n  // Account Removal State\n  const [isDeleteModalOpen, setIsDeleteModalOpen] = useState(false);\n  const [accountToDelete, setAccountToDelete] = useState<Account | null>(null);\n\n  // URL Sync\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    let changed = false;\n\n    if (params.get('tab') !== activeTab) {\n        params.set('tab', activeTab);\n        changed = true;\n    }\n\n    if (currentAccount && params.get('account') !== currentAccount.id) {\n        params.set('account', currentAccount.id);\n        changed = true;\n    }\n\n    if (changed) {\n        const newUrl = `${window.location.pathname}?${params.toString()}`;\n        window.history.replaceState({}, '', newUrl);\n    }\n  }, [activeTab, currentAccount]);\n\n  // Account Dropdown Reference for click-outside\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsAccountDropdownOpen(false);\n      }\n    };\n\n    if (isAccountDropdownOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n    \n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isAccountDropdownOpen]);\n\n  // Load Data\n  const loadData = async (initialLoad = false, targetAccountId?: string) => {\n    setIsLoading(true);\n    try {\n      const dashboardData = await getDashboardInfo();\n      const { accounts: accountData, plan_type } = dashboardData;\n      \n      // Always update plan even if no accounts\n      setSettings(prev => ({\n          ...prev,\n          plan: (plan_type || '') as PlanType\n      }));\n\n      // If no plan, force to plan tab\n      if (!plan_type) {\n          setActiveTab('plan');\n      }\n      \n      // Fetch Location & Plans (Dynamic Pricing)\n      if (initialLoad) {\n        try {\n            // 1. Detect Country with Fallback\n            try {\n                const res = await fetch('https://ipapi.co/json/');\n                if (res.status === 429) throw new Error('429');\n                const data = await res.json();\n                setCurrency(data.country_code === 'IN' ? 'INR' : 'USD');\n            } catch (e) {\n                try {\n                    const res = await fetch('http://ip-api.com/json/');\n                    const data = await res.json();\n                    setCurrency(data.countryCode === 'IN' ? 'INR' : 'USD');\n                } catch (e2) {\n                    console.warn(\"Location detection failed, defaulting to USD\");\n                    setCurrency('USD');\n                }\n            }\n\n            // 2. Fetch Plans from Backend\n            const plans = await getPlans();\n            setRazorpayPlans(plans);\n        } catch (e) {\n            console.error(\"Failed to load dynamic pricing:\", e);\n        }\n      }\n\n      if (accountData.length > 0) {\n        const mappedAccounts = accountData.map(acc => ({\n            id: acc.account_id,\n            name: acc.account_name,\n            handle: acc.account_name.toLowerCase().replace(/\\s+/g, '_'), // Remove mock '@' prefix\n            profilePictureUrl: acc.profile_picture_url,\n            isDeauthorized: acc.is_deauthorized || false\n        }));\n        setAccounts(mappedAccounts);\n\n        // Find current or set default\n        const params = new URLSearchParams(window.location.search);\n        const urlAccountId = params.get('account');\n        \n        const effectiveAccountId = targetAccountId || urlAccountId || currentAccount?.id;\n        let selected = accountData.find(a => a.account_id === effectiveAccountId) || accountData[0];\n        \n        setCurrentAccount({\n            id: selected.account_id,\n            name: selected.account_name,\n            handle: selected.account_name.toLowerCase().replace(/\\s+/g, '_'),\n            profilePictureUrl: selected.profile_picture_url,\n            isDeauthorized: selected.is_deauthorized || false\n        });\n        setRawAccountInfo(selected);\n\n        // Map policies string to object\n        const pList = selected.policies.split(',').map(s => s.trim());\n\n        const newSettings: UserSettings = {\n            plan: (plan_type || 'standard') as PlanType,\n            policies: {\n                profanity: pList.includes('profanity'),\n                sexualContent: pList.includes('sexualContent'),\n                hateSpeech: pList.includes('hateSpeech'),\n                selfHarm: pList.includes('selfHarm'),\n                violence: pList.includes('violence'),\n                negativity: pList.includes('negativity'),\n                harassment: pList.includes('harassment'),\n                spam: pList.includes('spam')\n            },\n            customInstructions: selected.custom_policy || '',\n            confidenceThreshold: selected.confidence_threshold || 80,\n            selectedCustomPolicies: (() => {\n                try {\n                    const parsed = JSON.parse(selected.custom_policy || '[]');\n                    return Array.isArray(parsed) ? parsed : [];\n                } catch {\n                    return [];\n                }\n            })(),\n            customPolicyDescriptions: (selected.custom_policy_definitions || []).reduce((acc: any, d: any) => {\n                acc[d.policy_name] = d.description;\n                return acc;\n            }, {})\n        };\n\n        setSettings(newSettings);\n        setOriginalSettings(newSettings);\n\n\n        await fetchInterventions(selected.account_id, interventionsLimit);\n\n        setStats({\n          scanned: selected?.stats?.comments_scanned ?? 0,\n          moderated: selected?.stats?.comments_moderated ?? 0,\n          averageResponseTime: selected?.stats?.comments_moderated > 0 \n            ? (selected?.stats?.processing_time ?? 0) / selected.stats.comments_moderated \n            : 0\n        });\n      } else {\n          // No accounts found\n          setAccounts([]);\n          setCurrentAccount(null);\n          \n          setStats({\n            scanned: 0,\n            moderated: 0,\n            averageResponseTime: 0\n          });\n      }\n    } catch (error: any) {\n        console.error(\"Failed to load dashboard data\", error);\n        if (error.status === 401 || error.status === 403) {\n            showToast(\"Session expired. Logging out...\", \"error\");\n            setTimeout(() => onLogout?.(), 2000);\n        } else {\n            showToast(\"Failed to load dashboard data\", \"error\");\n        }\n    } finally {\n        setIsLoading(false);\n    }\n  };\n  const fetchInterventions = async (accountId: string, limit: number) => {\n    setIsLoadingInterventions(true);\n    try {\n        const interventionsData = await getInterventions(accountId, limit);\n        const mappedActivity: ModeratedCommentLog[] = interventionsData.map(item => ({\n            id: item.comment_id,\n            author: item.username || 'Anonymous', \n            text: item.text,\n            riskLevel: (item.riskLevel || 'SAFE') as CommentRiskLevel,\n            timestamp: formatTimestamp(item.moderated_at),\n            actionTaken: item.suggested_action || 'NONE',\n            commenter_id: item.commenter_id\n        }));\n        setActivity(mappedActivity);\n    } catch (err) {\n        console.error(\"Failed to load interventions\", err);\n        showToast(\"Failed to load recent interventions\", \"error\");\n    } finally {\n        setIsLoadingInterventions(false);\n    }\n  };\n\n  const handleLoadMore = () => {\n    if (!currentAccount) return;\n    const newLimit = interventionsLimit + 10;\n    setInterventionsLimit(newLimit);\n    fetchInterventions(currentAccount.id, newLimit);\n  };\n\n  // Helper to format timestamp\n  const formatTimestamp = (ts: number | string) => {\n    if (!ts) return 'Unknown';\n    const now = Math.floor(Date.now() / 1000);\n    const diff = now - Number(ts);\n    \n    if (diff < 60) return 'Just now';\n    if (diff < 3600) return `${Math.floor(diff / 60)}m ago`;\n    if (diff < 86400) return `${Math.floor(diff / 3600)}h ago`;\n    return `${Math.floor(diff / 86400)}d ago`;\n  };\n\n\n  useEffect(() => {\n    loadData(true);\n    checkMFA();\n\n    // Check for Instagram OAuth code in URL\n    const urlParams = new URLSearchParams(window.location.search);\n    const code = urlParams.get('code');\n    if (code) {\n      handleInstagramCallback(code);\n    } else {\n        // but loadData is already called with true above\n    }\n  }, []);\n\n  const checkMFA = async () => {\n    try {\n        const isEnabled = await getMFAStatus();\n        setMfaStatus(isEnabled);\n    } catch (error) {\n        console.error(\"Failed to check MFA status\", error);\n    }\n  };\n\n  const handleInstagramCallback = async (code: string) => {\n    setIsLoading(true);\n    try {\n      const result = await addInstagramAccount(code);\n      \n      // Clean up URL\n      window.history.replaceState({}, document.title, window.location.pathname);\n      \n      // Refresh data\n      await loadData();\n      showToast('Account linked successfully!');\n    } catch (error: any) {\n      console.error(\"Failed to link Instagram account\", error);\n      // Clean up URL even on error\n      window.history.replaceState({}, document.title, window.location.pathname);\n      \n      if (error.status === 403) {\n          showToast(\"Subscription required to link account\", \"error\");\n          setActiveTab('plan');\n      } else if (error.status === 401) {\n          showToast(\"Session expired. Logging out...\", \"error\");\n          setTimeout(() => onLogout?.(), 2000);\n\n      } else {\n          showToast(error.message || \"Failed to link Instagram account\", \"error\");\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n\n  const handleEnableMFA = async () => {\n    setIsMFAInitLoading(true);\n    try {\n        const secret = await initiateMFASetup();\n        setMfaSecret(secret);\n        setIsMFASetupOpen(true);\n    } catch (error: any) {\n        showToast(error.message || \"Failed to initiate MFA setup\", \"error\");\n    } finally {\n        setIsMFAInitLoading(false);\n    }\n  };\n\n  const handleVerifyMFA = async () => {\n    if (!mfaVerificationCode) return;\n    setIsMFAVerifyLoading(true);\n    try {\n        await finalizeMFASetup(mfaVerificationCode);\n        setMfaStatus(true);\n        setIsMFASetupOpen(false);\n        setMfaSecret(null);\n        setMfaVerificationCode('');\n        showToast(\"MFA enabled successfully!\");\n    } catch (error: any) {\n        showToast(error.message || \"Invalid code\", \"error\");\n    } finally {\n        setIsMFAVerifyLoading(false);\n    }\n  };\n\n  const handleDisableMFA = async () => {\n    try {\n        await disableMFA();\n        setMfaStatus(false);\n        showToast(\"MFA disabled\");\n    } catch (error: any) {\n        showToast(error.message || \"Failed to disable MFA\", \"error\");\n    }\n  };\n\n  const handleSaveSettings = async () => {\n    if (!currentAccount || !rawAccountInfo) return;\n\n    setIsSaving(true);\n    try {\n        const policiesStr = Object.entries(settings.policies)\n            .filter(([_, v]) => v)\n            .map(([k, _]) => k)\n            .join(', ');\n\n        await saveDashboardControls(\n            currentAccount.id,\n            rawAccountInfo.owner_user_id,\n            policiesStr,\n            settings.plan,\n            JSON.stringify(settings.selectedCustomPolicies),\n            settings.confidenceThreshold\n        );\n      \n      // We assume custom policies are saved individually as they change, \n      // but for the sake of \"Dirty State\" we treat them as part of the whole snapshot.\n      // Ideally custom policies save immediately, but if we want to batch them, we'd need bulk update API.\n      // For now, let's assume 'saveDashboardControls' only does standard + threshold.\n      // But we update originalSettings to match current settings to clear dirty state.\n      \n      setOriginalSettings(settings);\n      showToast('Settings saved successfully!');\n    } catch (error: any) {\n        console.error(\"Failed to save settings\", error);\n        if (error.status === 401 || error.status === 403) {\n            showToast(\"Session expired. Logging out...\", \"error\");\n            setTimeout(() => onLogout?.(), 2000);\n        } else {\n            showToast(\"Failed to save settings: \" + (error.message || \"Unknown error\"), \"error\");\n        }\n    } finally {\n        setIsSaving(false);\n    }\n  };\n\n  const handleSaveCustomPolicy = async () => {\n    if (!currentAccount || !newPolicyName || !newPolicyCondition) return;\n    \n    const structuredDescription = `Treat comments with ${newPolicyCondition} as ${newPolicyAction}`;\n    if (structuredDescription.length > 100) {\n        showToast(\"Description is too long (max 100 characters combined)\", \"error\");\n        return;\n    }\n\n    try {\n        setIsSaving(true);\n        await saveCustomPolicyApi(currentAccount.id, newPolicyName, structuredDescription);\n        \n        // Refresh local state\n        setSettings(prev => ({\n            ...prev,\n            customPolicyDescriptions: {\n                ...prev.customPolicyDescriptions,\n                [newPolicyName]: structuredDescription\n            }\n        }));\n\n        setIsCustomPolicyFormOpen(false);\n        setNewPolicyName('');\n        setNewPolicyCondition('');\n        setNewPolicyAction('spam');\n        setEditingPolicyName(null);\n        showToast(\"Custom policy saved successfully\");\n    } catch (error: any) {\n        if (error.status === 403 && settings.plan === 'pro') {\n            showToast(\"Limit reached. Upgrade to Max for up to 20 custom policies.\", \"error\");\n        } else {\n            showToast(error.message || \"Failed to save custom policy\", \"error\");\n        }\n    } finally {\n        setIsSaving(false);\n    }\n  };\n\n  const handleDeleteCustomPolicy = async (policyName: string) => {\n    if (!currentAccount) return;\n\n    try {\n        setIsSaving(true);\n        await deleteCustomPolicyApi(currentAccount.id, policyName);\n        \n        // Refresh local state\n        setSettings(prev => {\n            const nextDefs = { ...prev.customPolicyDescriptions };\n            delete nextDefs[policyName];\n            return {\n                ...prev,\n                selectedCustomPolicies: prev.selectedCustomPolicies.filter(p => p !== policyName),\n                customPolicyDescriptions: nextDefs\n            };\n        });\n\n        showToast(\"Custom policy deleted\");\n    } catch (error: any) {\n        showToast(error.message || \"Failed to delete custom policy\", \"error\");\n    } finally {\n        setIsSaving(false);\n    }\n  };\n\n  const toggleCustomPolicy = (policyName: string) => {\n      setSettings(prev => ({\n          ...prev,\n          selectedCustomPolicies: prev.selectedCustomPolicies.includes(policyName)\n            ? prev.selectedCustomPolicies.filter(p => p !== policyName)\n            : [...prev.selectedCustomPolicies, policyName]\n      }));\n  };\n\n\n  const handleAction = async (id: string, action: 'SAFE' | 'DELETE') => {\n    if (!currentAccount) return;\n    \n    // Find the comment in activity\n    const comment = activity.find(c => c.id === id);\n    if (!comment) return;\n\n    try {\n        // Match frontend action to API action_type\n        const actionType = 'COMMENT';\n\n        await processIntervention(\n            currentAccount.id, \n            id, \n            comment.commenter_id || null, \n            action, \n            actionType\n        );\n        \n        showToast(`Action \"${action}\" queued. It will be synced in a few minutes.`);\n    } catch (error) {\n        console.error(\"Failed to process intervention\", error);\n        showToast(\"Failed to process intervention\", \"error\");\n    }\n  };\n\n  const handleDeleteAccount = async () => {\n    if (!accountToDelete) return;\n    \n    setIsSaving(true);\n    try {\n        await removeInstagramAccount(accountToDelete.id);\n        showToast(\"Account removed successfully\");\n        setIsDeleteModalOpen(false);\n        setAccountToDelete(null);\n        \n        // Refresh dashboard\n        loadData(true);\n    } catch (error: any) {\n        showToast(error.message || \"Failed to remove account\", \"error\");\n    } finally {\n        setIsSaving(false);\n    }\n  };\n\n  const handleSwitchAccount = (account: Account) => {\n    if (currentAccount && account.id === currentAccount.id) {\n        setIsAccountDropdownOpen(false);\n        return;\n    }\n    setCurrentAccount(account);\n    setIsAccountDropdownOpen(false);\n    loadData(false, account.id); // Re-fetch data for new account\n  };\n\n  const handleChangePlan = async (newPlan: PlanType) => {\n    if (newPlan === settings.plan) return;\n    \n    setIsProcessingPayment(true);\n    \n    // 1. Load the Razorpay SDK\n    const res = await loadRazorpayScript();\n\n    if (!res) {\n      showToast('Razorpay SDK failed to load. Please check your internet connection.', 'error');\n      setIsProcessingPayment(false);\n      return;\n    }\n\n    // 2. Find matching backend plan\n    const targetPlan = razorpayPlans.find(p => \n        p.name.toLowerCase().includes(PLANS[newPlan].label.toLowerCase()) && \n        p.currency === currency\n    );\n\n    let subscriptionId = null;\n    if (targetPlan) {\n        // Create Subscription on Backend\n        subscriptionId = await createSubscription(targetPlan.id);\n        if (!subscriptionId) {\n             showToast('Failed to initialize subscription. Please try again.', 'error');\n             setIsProcessingPayment(false);\n             return;\n        }\n    } else {\n        console.warn(\"No matching Razorpay plan found for\", newPlan, currency);\n        // Fallback or Error? \n        // For now, let's allow \"Test Mode\" fallback using legacy One-Time Payment loop if no plan found\n        // But in prod this should probably block.\n    }\n\n    // 3. Define Razorpay Options\n    const options: any = {\n      key: process.env.NEXT_PUBLIC_RAZORPAY_KEY_ID || 'rzp_test_PLACEHOLDER_KEY',\n      name: 'ShieldGram',\n      description: `Upgrade to ${PLANS[newPlan].label} Plan`,\n      image: 'https://cdn-icons-png.flaticon.com/512/3233/3233515.png',\n      handler: function (response: any) {\n        console.log('Payment Success: ', response);\n        // In production, verify signature on backend:\n        // response.razorpay_payment_id, response.razorpay_subscription_id, response.razorpay_signature\n\n        setSettings(prev => ({ ...prev, plan: newPlan }));\n        setIsProcessingPayment(false);\n        showToast(`Subscription updated to ${PLANS[newPlan].label}!`);\n      },\n      prefill: {\n        name: currentAccount?.name || \"ShieldGram User\",\n        email: \"user@example.com\", \n        contact: \"\"\n      },\n      theme: { color: \"#6bb8e6\" },\n      modal: {\n        ondismiss: function() { setIsProcessingPayment(false); }\n      }\n    };\n\n    if (subscriptionId) {\n        options.subscription_id = subscriptionId;\n    } else {\n        // Fallback to one-time payment (Legacy/Test)\n        options.amount = PLANS[newPlan].price * 100;\n        options.currency = 'USD'; // Default fallback\n    }\n\n    // 4. Open Razorpay\n    const paymentObject = new (window as any).Razorpay(options);\n    paymentObject.open();\n  };\n\n  const canEditCustomPolicy = settings.plan === 'pro' || settings.plan === 'max';\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 dark:bg-slate-950 transition-colors duration-300 flex flex-col\">\n      {/* <SEO title=\"Dashboard\" description=\"Manage your ShieldGram protection settings and analytics.\" /> */}\n      {/* Standalone Dashboard Header */}\n      <header className=\"bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 sticky top-0 z-40\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n             <img src=\"/logo.svg\" alt=\"ShieldGram\" className=\"h-[44px] w-auto\" />\n            <span className=\"font-bold text-lg text-slate-900 dark:text-white tracking-tight hidden sm:inline\">ShieldGram <span className=\"text-slate-400 font-normal ml-1\">Dashboard</span></span>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n             {/* Account Switcher */}\n              <div className=\"relative\" ref={dropdownRef}>\n                <button\n                    onClick={() => setIsAccountDropdownOpen(!isAccountDropdownOpen)}\n                    className={`flex items-center gap-3 px-2 py-1.5 rounded-lg transition-all border border-transparent focus:outline-none ${\n                        !currentAccount ? 'bg-brand-50 dark:bg-brand-900/20 text-brand-600 dark:text-brand-400' : 'hover:bg-slate-100 dark:hover:bg-slate-800 hover:border-slate-200 dark:hover:border-slate-700'\n                    }`}\n                >\n                    <div className=\"w-8 h-8 rounded-full bg-brand-600 text-white flex items-center justify-center font-bold text-xs shadow-sm overflow-hidden shrink-0\">\n                        {currentAccount?.profilePictureUrl ? (\n                            <img src={currentAccount.profilePictureUrl} alt=\"\" className=\"w-full h-full object-cover\" />\n                        ) : (\n                            currentAccount ? currentAccount.name.substring(0,2).toUpperCase() : <Shield className=\"w-4 h-4\" />\n                        )}\n                    </div>\n                    <div className=\"hidden md:block text-left mr-1\">\n                        <p className={`text-sm font-semibold leading-none ${!currentAccount ? 'text-brand-700 dark:text-brand-300' : 'text-slate-700 dark:text-slate-200'}`}>\n                            {currentAccount?.name || (isLoading ? 'Loading...' : 'Select Account')}\n                        </p>\n                        <p className=\"text-[10px] text-slate-500 dark:text-slate-400 font-medium leading-none mt-1.5\">\n                            {currentAccount?.handle || (isLoading ? '' : 'None active')}\n                        </p>\n                    </div>\n                    <ChevronDown className={`w-4 h-4 text-slate-400 transition-transform ${isAccountDropdownOpen ? 'rotate-180' : ''}`} />\n                </button>\n\n                {isAccountDropdownOpen && (\n                    <div className=\"absolute right-0 top-full mt-2 w-64 bg-white dark:bg-slate-900 rounded-xl shadow-xl border border-slate-200 dark:border-slate-800 overflow-hidden z-50 animate-fade-in ring-1 ring-black/5\">\n                        <div className=\"p-2 space-y-0.5\">\n                            <div className=\"px-3 py-2 text-[10px] font-bold text-slate-400 uppercase tracking-wider\">Switch Account</div>\n                            {accounts.map(account => (\n                                <button\n                                    key={account.id}\n                                    onClick={() => handleSwitchAccount(account)}\n                                    className={`w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm transition-all ${\n                                        currentAccount.id === account.id \n                                        ? 'bg-brand-50 dark:bg-brand-900/20 text-brand-700 dark:text-brand-300 font-medium' \n                                        : 'hover:bg-slate-50 dark:hover:bg-slate-800 text-slate-700 dark:text-slate-300'\n                                    }`}\n                                >\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-xs border overflow-hidden ${\n                                            currentAccount.id === account.id \n                                            ? 'bg-brand-200 dark:bg-brand-800 border-brand-300 dark:border-brand-700' \n                                            : 'bg-slate-100 dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-500'\n                                        }`}>\n                                            {account.profilePictureUrl ? (\n                                                <img src={account.profilePictureUrl} alt=\"\" className=\"w-full h-full object-cover\" />\n                                            ) : (\n                                                account.name.substring(0,2).toUpperCase()\n                                            )}\n                                        </div>\n                                        <div className=\"text-left\">\n                                            <p>{account.name}</p>\n                                            <p className=\"text-xs opacity-60 font-normal\">{account.handle}</p>\n                                        </div>\n                                    </div>\n                                    {currentAccount.id === account.id && <Check className=\"w-4 h-4 text-brand-600\" />}\n                                </button>\n                            ))}\n                        </div>\n                        <div className=\"border-t border-slate-100 dark:border-slate-800 p-2\">\n                            <button \n                                onClick={() => {\n                                   const authUrl = process.env.NEXT_PUBLIC_INSTAGRAM_AUTH_URL;\n                                   if (authUrl) {\n                                       window.location.href = authUrl;\n                                   } else {\n                                       showToast(\"Error: VITE_INSTAGRAM_AUTH_URL is not defined.\", \"error\");\n                                   }\n                                   setIsAccountDropdownOpen(false);\n                                }}\n\n                                className=\"w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors font-medium group\"\n                            >\n                                <div className=\"w-8 h-8 rounded-full bg-slate-50 dark:bg-slate-800 flex items-center justify-center border border-dashed border-slate-300 dark:border-slate-600 group-hover:border-slate-400 dark:group-hover:border-slate-500 transition-colors\">\n                                    <Plus className=\"w-4 h-4\" />\n                                </div>\n                                <span>Add New Account</span>\n                            </button>\n\n                        </div>\n                    </div>\n                )}\n             </div>\n\n             <div className=\"h-8 w-px bg-slate-200 dark:bg-slate-800 mx-2\"></div>\n\n             {toggleTheme && (\n                <button\n                onClick={toggleTheme}\n                className=\"p-2 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors\"\n                title=\"Toggle Theme\"\n                >\n                {isDarkMode ? <Sun className=\"w-5 h-5\" /> : <Moon className=\"w-5 h-5\" />}\n                </button>\n             )}\n             \n             {onLogout && (\n                <button \n                  onClick={onLogout}\n                  className=\"flex items-center gap-2 text-sm font-medium text-slate-600 dark:text-slate-300 hover:text-red-600 dark:hover:text-red-400 transition-colors\"\n                >\n                  <LogOut className=\"w-4 h-4\" />\n                  <span className=\"hidden sm:inline\">Sign Out</span>\n                </button>\n             )}\n          </div>\n        </div>\n      </header>\n\n      {/* Tabs */}\n      <div className=\"bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800\">\n         <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <div className=\"flex space-x-8\">\n               <button\n                 onClick={() => setActiveTab('overview')}\n                 disabled={!settings.plan}\n                 className={`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors ${\n                    activeTab === 'overview' \n                    ? 'border-brand-600 text-brand-600 dark:border-brand-400 dark:text-brand-400' \n                    : 'border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300'\n                 } ${!settings.plan ? 'opacity-50 cursor-not-allowed' : ''}`}\n               >\n                  <LayoutDashboard className=\"w-4 h-4\" /> Overview {!settings.plan && <Lock className=\"w-3 h-3\" />}\n               </button>\n               <button\n                 onClick={() => setActiveTab('controls')}\n                 disabled={!settings.plan}\n                 className={`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors ${\n                    activeTab === 'controls' \n                    ? 'border-brand-600 text-brand-600 dark:border-brand-400 dark:text-brand-400' \n                    : 'border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300'\n                 } ${!settings.plan ? 'opacity-50 cursor-not-allowed' : ''}`}\n               >\n                  <Sliders className=\"w-4 h-4\" /> Controls {!settings.plan && <Lock className=\"w-3 h-3\" />}\n               </button>\n               <button\n                 onClick={() => setActiveTab('plan')}\n                 className={`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors ${\n                    activeTab === 'plan' \n                    ? 'border-brand-600 text-brand-600 dark:border-brand-400 dark:text-brand-400' \n                    : 'border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300'\n                 }`}\n               >\n                  <CreditCard className=\"w-4 h-4\" /> Plan & Billing\n               </button>\n               <button\n                 onClick={() => setActiveTab('security')}\n                 disabled={!settings.plan}\n                 className={`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors ${\n                    activeTab === 'security' \n                    ? 'border-brand-600 text-brand-600 dark:border-brand-400 dark:text-brand-400' \n                    : 'border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300'\n                 } ${!settings.plan ? 'opacity-50 cursor-not-allowed' : ''}`}\n               >\n                  <Lock className=\"w-4 h-4\" /> Security {!settings.plan && <Lock className=\"w-3 h-3\" />}\n               </button>\n            </div>\n         </div>\n      </div>\n\n      <main className=\"flex-grow py-8\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          \n          {notification && (\n            <div className={`fixed top-24 right-4 sm:right-8 z-50 flex items-center gap-2 text-sm font-medium px-4 py-3 rounded-lg shadow-xl border animate-slide-in max-w-[calc(100vw-2rem)] sm:max-w-md ${\n                notification.type === 'success'\n                ? 'text-green-700 dark:text-green-300 bg-green-50 dark:bg-green-900/90 border-green-200 dark:border-green-800'\n                : 'text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/90 border-red-200 dark:border-red-800'\n            }`}>\n                {notification.type === 'success' ? <CheckCircle className=\"w-5 h-5 shrink-0\" /> : <AlertCircle className=\"w-5 h-5 shrink-0\" />} \n                <span className=\"truncate\">{notification.message}</span>\n            </div>\n          )}\n\n          {isLoading ? (\n             <div className=\"flex flex-col justify-center items-center h-96 gap-4\">\n                <div className=\"relative\">\n                    <div className=\"w-16 h-16 border-4 border-brand-100 dark:border-brand-900 rounded-full border-t-brand-600 animate-spin\"></div>\n                    <Shield className=\"w-6 h-6 text-brand-600 absolute inset-0 m-auto\" />\n                </div>\n                <p className=\"text-slate-500 font-medium animate-pulse\">Syncing your protection...</p>\n             </div>\n          ) : (accounts.length === 0 && activeTab !== 'plan') ? (\n            <div className=\"max-w-4xl mx-auto text-center py-20 px-6 animate-fade-in\">\n                 <div className=\"w-24 h-24 bg-brand-50 dark:bg-brand-900/20 rounded-3xl flex items-center justify-center mx-auto mb-8 rotate-3 shadow-inner text-brand-600\">\n                    <ShieldCheck className=\"w-12 h-12\" />\n                 </div>\n                 \n                 <h2 className=\"text-3xl font-extrabold text-slate-900 dark:text-white mb-4 tracking-tight\">Ready to Secure Your Growth?</h2>\n                 <p className=\"text-lg text-slate-600 dark:text-slate-400 mb-10 max-w-xl mx-auto leading-relaxed\">\n                    Link your Instagram account to start automated AI moderation. ShieldGram protects your brand from spam and toxicity 24/7.\n                 </p>\n                 {settings.plan ? (\n                    <div className=\"flex flex-col sm:flex-row items-center justify-center gap-4\">\n                        <button \n                            onClick={() => {\n                                const authUrl = process.env.NEXT_PUBLIC_INSTAGRAM_AUTH_URL;\n                                if (authUrl) window.location.href = authUrl;\n                                else showToast(\"Auth URL not configured\", \"error\");\n                            }}\n                            className=\"w-full sm:w-auto px-8 py-4 bg-brand-600 hover:bg-brand-700 text-white rounded-xl font-bold shadow-xl shadow-brand-500/20 transition-all flex items-center justify-center gap-2 group\"\n                        >\n                            <Plus className=\"w-5 h-5 group-hover:rotate-90 transition-transform\" /> Connect Instagram\n                        </button>\n                        <button \n                            onClick={() => setActiveTab('plan')}\n                            className=\"w-full sm:w-auto px-8 py-4 bg-white dark:bg-slate-900 text-slate-700 dark:text-slate-300 border border-slate-200 dark:border-slate-800 rounded-xl font-bold hover:bg-slate-50 dark:hover:bg-slate-800 transition-all\"\n                        >\n                            Manage Plan\n                        </button>\n                    </div>\n                 ) : (\n                    <div className=\"flex flex-col items-center gap-6\">\n                        <p className=\"text-sm font-bold text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-900/20 px-4 py-2 rounded-full border border-amber-100 dark:border-amber-900/30\">\n                            Choose a Plan First\n                        </p>\n                        <button \n                            onClick={() => setActiveTab('plan')}\n                            className=\"w-full sm:w-auto px-10 py-4 bg-brand-600 hover:bg-brand-700 text-white rounded-xl font-bold shadow-xl shadow-brand-500/20 transition-all flex items-center justify-center gap-2 group\"\n                        >\n                            View Subscription Plans <RefreshCw className=\"w-4 h-4 group-hover:rotate-180 transition-transform duration-500\" />\n                        </button>\n                    </div>\n                 )}\n                 \n                 <div className=\"mt-16 grid grid-cols-1 sm:grid-cols-3 gap-8 opacity-60\">\n                    <div className=\"flex items-center gap-3 justify-center\">\n                        <Zap className=\"w-5 h-5 text-brand-500\" /> <span className=\"text-sm font-medium\">Real-time AI</span>\n                    </div>\n                    <div className=\"flex items-center gap-3 justify-center\">\n                        <Lock className=\"w-5 h-5 text-purple-500\" /> <span className=\"text-sm font-medium\">Spam-free feed</span>\n                    </div>\n                    <div className=\"flex items-center gap-3 justify-center\">\n                        <ShieldAlert className=\"w-5 h-5 text-red-500\" /> <span className=\"text-sm font-medium\">Policy Enforced</span>\n                    </div>\n                 </div>\n            </div>\n          ) : (\n            <>\n              {/* --- OVERVIEW TAB --- */}\n              {activeTab === 'overview' && (\n                <div className=\"animate-fade-in relative\">\n                  {/* Deauthorization Warning Overlay */}\n                  {currentAccount?.isDeauthorized && (\n                    <div className=\"absolute inset-0 z-10 flex items-center justify-center\">\n                      <div className=\"absolute inset-0 bg-white/80 dark:bg-slate-950/80 backdrop-blur-sm rounded-xl\"></div>\n                      <div className=\"relative bg-white dark:bg-slate-900 border border-red-200 dark:border-red-800 rounded-2xl p-8 max-w-md text-center shadow-xl\">\n                        <div className=\"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4\">\n                          <ShieldAlert className=\"w-8 h-8 text-red-500\" />\n                        </div>\n                        <h3 className=\"text-xl font-bold text-slate-900 dark:text-white mb-2\">Account Disconnected</h3>\n                        <p className=\"text-slate-600 dark:text-slate-400 mb-6\">\n                          You have de-authorized ShieldGram from your Instagram account. Please reconnect to resume protection.\n                        </p>\n                        <button\n                          onClick={() => {\n                              const redirectUri = `${window.location.origin}/dashboard`;\n                              const clientId = process.env.NEXT_PUBLIC_INSTAGRAM_CLIENT_ID;\n                              const instagramAuthUrl = `https://www.instagram.com/oauth/authorize?enable_fb_login=0&force_authentication=1&client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=code&scope=instagram_business_basic,instagram_business_manage_comments,instagram_business_manage_messages`;\n                              window.location.href = instagramAuthUrl;\n                          }}\n                          className=\"px-6 py-3 rounded-xl font-semibold bg-brand-600 hover:bg-brand-700 text-white transition-all\"\n                        >\n                          Reconnect Instagram\n                        </button>\n                      </div>\n                    </div>\n                  )}\n                  <div className=\"flex items-center justify-between mb-8\">\n                    <h1 className=\"text-2xl font-bold text-slate-900 dark:text-white\">Overview</h1>\n                    <div className=\"flex items-center gap-4\">\n                        <button \n                            onClick={() => loadData()}\n                            disabled={isLoading}\n                            className=\"flex items-center gap-2 px-3 py-1.5 rounded-lg bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 text-slate-600 dark:text-slate-400 hover:text-brand-600 dark:hover:text-brand-400 hover:border-brand-200 dark:hover:border-brand-800 transition-all shadow-sm group\"\n                            title=\"Refresh Dashboard\"\n                        >\n                            <RefreshCw className={`w-4 h-4 group-hover:rotate-180 transition-transform duration-500 ${isLoading ? 'animate-spin' : ''}`} />\n                        </button>\n                        <span className=\"text-xs font-mono text-slate-400 flex items-center gap-2\">\n                           <span className={`px-2 py-0.5 rounded-full text-[10px] uppercase font-bold border ${\n                             settings.plan === 'max' ? 'bg-purple-100 text-purple-700 border-purple-200' : \n                             settings.plan === 'pro' ? 'bg-brand-100 text-brand-700 border-brand-200' :\n                             'bg-slate-100 text-slate-600 border-slate-200'\n                           }`}>\n                             {settings.plan} Plan\n                           </span>\n                        </span>\n                    </div>\n                  </div>\n\n                  {/* Stats Grid */}\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12\">\n                    <div className=\"bg-white dark:bg-slate-900 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 transition-colors\">\n                      <div className=\"flex justify-between items-start\">\n                        <div>\n                          <p className=\"text-sm font-medium text-slate-500 dark:text-slate-400\">Comments Scanned</p>\n                          <h3 className=\"text-3xl font-bold text-slate-900 dark:text-white mt-2\">{stats.scanned.toLocaleString()}</h3>\n                          <p className=\"text-xs text-green-600 dark:text-green-400 mt-2 flex items-center gap-1\">\n                            <span className=\"text-sm font-medium text-slate-500 dark:text-slate-400\">Total Scanned</span>\n                          </p>\n                        </div>\n                        <div className=\"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg\">\n                          <BarChart3 className=\"w-6 h-6 text-brand-600 dark:text-brand-400\" />\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"bg-white dark:bg-slate-900 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 transition-colors\">\n                      <div className=\"flex justify-between items-start\">\n                        <div>\n                          <p className=\"text-sm font-medium text-slate-500 dark:text-slate-400\">Threats Blocked</p>\n                          <h3 className=\"text-3xl font-bold text-slate-900 dark:text-white mt-2\">{stats.moderated.toLocaleString()}</h3>\n                          <p className=\"text-xs text-green-600 dark:text-green-400 mt-2 flex items-center gap-1\">\n                            <span className=\"text-sm font-medium text-slate-500 dark:text-slate-400\">Total Moderated</span>\n                          </p>\n                        </div>\n                        <div className=\"p-3 bg-red-50 dark:bg-red-900/20 rounded-lg\">\n                          <ShieldAlert className=\"w-6 h-6 text-red-600 dark:text-red-400\" />\n                        </div>\n                      </div>\n                    </div>\n\n                    <div className=\"bg-white dark:bg-slate-900 p-6 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 transition-colors\">\n                      <div className=\"flex justify-between items-start\">\n                        <div>\n                          <p className=\"text-sm font-medium text-slate-500 dark:text-slate-400\">Avg. Response Time</p>\n                          <h3 className=\"text-3xl font-bold text-slate-900 dark:text-white mt-2\">\n                             {stats.averageResponseTime === 0 ? '-' : \n                              stats.averageResponseTime < 1 ? '< 1s' : \n                              `${stats.averageResponseTime.toFixed(1)}s`}\n                          </h3>\n                          <p className=\"text-xs text-brand-600 dark:text-brand-400 mt-2 flex items-center gap-1\">\n                            <Zap className=\"w-3 h-3\" /> <span className=\"font-bold\">Fast Protection</span>\n                          </p>\n                        </div>\n                        <div className=\"p-3 bg-brand-50 dark:bg-brand-900/20 rounded-lg\">\n                          <Zap className=\"w-6 h-6 text-brand-600 dark:text-brand-400\" />\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Recent Activity */}\n                  <div className=\"mb-8\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4\">\n                      <h2 className=\"text-lg font-semibold text-slate-900 dark:text-white\">Recent Automated Interventions</h2>\n                    </div>\n                    {activity.length === 0 ? (\n                       <div className=\"text-center py-12 bg-white dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-800 border-dashed\">\n                          <p className=\"text-slate-500\">No activity logged yet.</p>\n                       </div>\n                    ) : (\n                      <div className=\"grid gap-4\">\n                          {activity.map((comment) => (\n                            <div key={comment.id} className=\"bg-white dark:bg-slate-900 p-4 rounded-lg shadow-sm border border-slate-200 dark:border-slate-800 flex flex-col sm:flex-row sm:items-center justify-between gap-4 transition-colors\">\n                              <div className=\"flex items-start gap-4\">\n                                <div>\n                                    <div className=\"flex items-center gap-2\">\n                                      <span className=\"font-semibold text-slate-900 dark:text-slate-100\">{comment.author}</span>\n                                      <span className=\"text-xs text-slate-400 dark:text-slate-500\">{comment.timestamp}</span>\n                                    </div>\n                                    <p className=\"text-slate-600 dark:text-slate-300 mt-1 text-sm bg-slate-50 dark:bg-slate-800 p-2 rounded border border-slate-100 dark:border-slate-700\">\n                                      {comment.text}\n                                    </p>\n                                    <div className=\"flex items-center gap-2 mt-2\">\n                                      {comment.riskLevel !== CommentRiskLevel.SAFE && (\n                                        <span className={`text-[10px] font-bold px-2 py-0.5 rounded-full border ${\n                                            comment.riskLevel === CommentRiskLevel.SPAM ? 'bg-yellow-50 text-yellow-700 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800' :\n                                            comment.riskLevel === CommentRiskLevel.TOXIC ? 'bg-red-50 text-red-700 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800' :\n                                            'bg-orange-50 text-orange-700 border-orange-200 dark:bg-orange-900/20 dark:text-orange-400 dark:border-orange-800'\n                                        }`}>\n                                            {comment.riskLevel}\n                                        </span>\n                                      )}\n                                      <span className={`text-[10px] uppercase font-medium ${comment.actionTaken === 'APPROVED' ? 'text-green-600 dark:text-green-400' : 'text-slate-400 dark:text-slate-500'}`}>\n                                          Action: {comment.actionTaken}\n                                      </span>\n                                    </div>\n                                </div>\n                              </div>\n\n                              <div className=\"flex items-center gap-2 self-end sm:self-center\">\n                                <button \n                                    onClick={() => handleAction(comment.id, 'SAFE')}\n                                    disabled={comment.actionTaken === 'DELETE'}\n                                    className={`p-2 rounded-lg transition-colors ${\n                                        comment.actionTaken === 'DELETE' \n                                        ? 'text-slate-200 dark:text-slate-800 cursor-not-allowed' \n                                        : 'text-slate-400 dark:text-slate-500 hover:text-green-600 dark:hover:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20'\n                                    }`}\n                                    title={comment.actionTaken === 'DELETE' ? \"Cannot restore deleted comment\" : \"Mark as Safe (False Positive)\"}\n                                >\n                                    <CheckCircle className=\"w-5 h-5\" />\n                                </button>\n                                <button \n                                    onClick={() => handleAction(comment.id, 'DELETE')}\n                                    disabled={comment.actionTaken === 'DELETE'}\n                                    className={`p-2 rounded-lg transition-colors ${\n                                        comment.actionTaken === 'DELETE' \n                                        ? 'text-slate-200 dark:text-slate-800 cursor-not-allowed' \n                                        : 'text-slate-400 dark:text-slate-500 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20'\n                                    }`}\n                                    title={comment.actionTaken === 'DELETE' ? \"Permanently Deleted\" : \"Delete Comment\"}\n                                >\n                                    <Trash2 className=\"w-5 h-5\" />\n                                </button>\n\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                    \n                    <button \n                      onClick={handleLoadMore}\n                      disabled={isLoadingInterventions}\n                      className=\"w-full py-3 text-sm text-slate-500 dark:text-slate-400 hover:text-brand-600 dark:hover:text-brand-400 font-medium border border-dashed border-slate-300 dark:border-slate-700 rounded-lg hover:border-brand-300 dark:hover:border-brand-600 hover:bg-brand-50 dark:hover:bg-brand-900/20 transition-all mt-4 flex items-center justify-center gap-2\"\n                    >\n                        {isLoadingInterventions ? (\n                          <>\n                            <div className=\"w-4 h-4 border-2 border-slate-300 border-t-brand-600 animate-spin rounded-full\"></div>\n                            Loading...\n                          </>\n                        ) : (\n                          \"Load More History\"\n                        )}\n                    </button>\n                  </div>\n                </div>\n              )}\n\n              {/* --- CONTROLS TAB --- */}\n              {activeTab === 'controls' && (\n                <div className=\"animate-fade-in max-w-3xl mx-auto relative\">\n                   {/* Deauthorization Warning Banner */}\n                   {currentAccount?.isDeauthorized && (\n                     <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 mb-8 text-center\">\n                       <div className=\"flex items-center justify-center gap-3 mb-3\">\n                         <ShieldAlert className=\"w-6 h-6 text-red-500\" />\n                         <h3 className=\"font-bold text-red-600 dark:text-red-400\">Account Disconnected</h3>\n                       </div>\n                       <p className=\"text-sm text-red-600/80 dark:text-red-400/80 mb-4\">\n                         Controls are disabled because you de-authorized ShieldGram. Reconnect your Instagram account or remove it below.\n                       </p>\n                       <button\n                         onClick={() => {\n                             const redirectUri = `${window.location.origin}/dashboard`;\n                             const clientId = process.env.NEXT_PUBLIC_INSTAGRAM_CLIENT_ID;\n                             const instagramAuthUrl = `https://www.instagram.com/oauth/authorize?enable_fb_login=0&force_authentication=1&client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=code&scope=instagram_business_basic,instagram_business_manage_comments,instagram_business_manage_messages`;\n                             window.location.href = instagramAuthUrl;\n                         }}\n                         className=\"px-5 py-2 rounded-lg font-semibold bg-red-600 hover:bg-red-700 text-white text-sm transition-all\"\n                       >\n                         Reconnect Instagram\n                       </button>\n                     </div>\n                   )}\n                   \n                   <div className=\"flex items-center justify-between mb-8\">\n                      <h1 className=\"text-2xl font-bold text-slate-900 dark:text-white\">Moderation Policy</h1>\n                      \n                      {notification && notification.type === 'success' && (\n                        <div className=\"flex items-center gap-2 text-sm text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20 px-3 py-1 rounded-full animate-fade-in\">\n                           <Check className=\"w-4 h-4\" /> {notification.message}\n                        </div>\n                      )}\n                   </div>\n\n                   {/* Plan Warning Banner */}\n                    {(!canEditCustomPolicy) && (\n                      <div className=\"bg-brand-50 dark:bg-brand-900/10 border border-brand-100 dark:border-brand-900 p-4 rounded-xl mb-8 flex items-start gap-3\">\n                         <Zap className=\"w-5 h-5 text-brand-600 dark:text-brand-400 mt-0.5 fill-current\" />\n                         <div>\n                            <h3 className=\"font-semibold text-brand-900 dark:text-brand-100\">Unlock Advanced Controls</h3>\n                            <p className=\"text-sm text-brand-700 dark:text-brand-300 mt-1\">\n                               You are currently on the <span className=\"font-bold uppercase\">{settings.plan}</span> plan. Upgrade to Pro or Max to define custom AI instructions and specific policy nuances.\n                            </p>\n                         </div>\n                         <button \n                             onClick={() => setActiveTab('plan')}\n                             className=\"ml-auto text-xs bg-brand-600 text-white px-3 py-2 rounded-lg font-medium hover:bg-brand-700\"\n                         >\n                            Upgrade\n                         </button>\n                      </div>\n                    )}\n\n\n                    {/* Controls Section - Disabled when deauthorized */}\n                    <div className={currentAccount?.isDeauthorized ? 'opacity-50 pointer-events-none select-none' : ''}>\n                        {/* Standard Protection */}\n                        <div className=\"bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 py-10 px-6\">\n                            <h3 className=\"font-semibold text-lg mb-6 text-slate-900 dark:text-white flex items-center gap-2\">\n                                <Shield className=\"w-5 h-5 text-brand-500\" /> Standard Protection\n                            </h3>\n                            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5\">\n                                {Object.entries(settings.policies).map(([key, value]) => {\n                                    const labels: Record<string, string> = {\n                                        profanity: 'Profanity',\n                                        sexualContent: 'Sexual Content',\n                                        hateSpeech: 'Hate Speech',\n                                        selfHarm: 'Self-harm',\n                                        violence: 'Violence',\n                                        negativity: 'Negativity',\n                                        harassment: 'Harassment',\n                                        spam: 'Spam'\n                                    };\n                                    const label = labels[key] || key;\n\n                                    return (\n                                        <label \n                                            key={key} \n                                            className={`\n                                                group relative flex items-center p-3 rounded-xl border cursor-pointer transition-all duration-200 select-none\n                                                ${value \n                                                    ? 'bg-brand-50/50 dark:bg-brand-900/10 border-brand-200 dark:border-brand-800 ring-1 ring-brand-200 dark:ring-brand-800' \n                                                    : 'bg-white dark:bg-slate-950/50 border-slate-200 dark:border-slate-800 hover:border-slate-300 dark:hover:border-slate-700'\n                                                }\n                                            `}\n                                        >\n                                            <input \n                                                type=\"checkbox\" \n                                                checked={value}\n                                                onChange={(e) => setSettings({...settings, policies: {...settings.policies, [key]: e.target.checked}})}\n                                                className=\"sr-only\"\n                                            />\n                                            <div className={`\n                                                w-5 h-5 rounded-md flex items-center justify-center transition-all duration-200 flex-shrink-0\n                                                ${value \n                                                    ? 'bg-brand-600 border border-brand-600 shadow-sm scale-100' \n                                                    : 'bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 scale-95 group-hover:scale-100'\n                                                }\n                                            `}>\n                                                <Check className={`w-3 h-3 text-white transition-all duration-200 ${value ? 'opacity-100 rotate-0' : 'opacity-0 -rotate-90'}`} strokeWidth={3} />\n                                            </div>\n                                            <span className={`ml-2 text-xs font-bold truncate ${value ? 'text-brand-900 dark:text-brand-100' : 'text-slate-700 dark:text-slate-300'}`}>\n                                                {label}\n                                            </span>\n                                        </label>\n                                    );\n                                })}\n                            </div>\n                        </div>\n\n                        {/* Custom Policies */}\n                        <div className={`bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 py-10 px-6 relative ${!canEditCustomPolicy ? 'opacity-70' : ''}`}>\n                            <div className=\"flex items-center justify-between mb-4\">\n                                <h3 className=\"font-semibold text-lg text-slate-900 dark:text-white flex items-center gap-2\">\n                                    <Sliders className=\"w-5 h-5 text-purple-500\" /> Custom Policies\n                                </h3>\n                                {canEditCustomPolicy && (\n                                    <button\n                                        onClick={() => {\n                                            setNewPolicyName('');\n                                            setNewPolicyCondition('');\n                                            setNewPolicyAction('spam');\n                                            setEditingPolicyName(null);\n                                            setIsCustomPolicyFormOpen(true);\n                                        }}\n                                        className=\"flex items-center gap-1.5 text-xs font-bold bg-brand-50 dark:bg-brand-900/20 text-brand-600 dark:text-brand-400 px-3 py-2 rounded-lg hover:bg-brand-100 dark:hover:bg-brand-900/40 transition-all border border-brand-200 dark:border-brand-800/50 uppercase tracking-tight\"\n                                    >\n                                        <Plus className=\"w-3.5 h-3.5\" /> Add New\n                                    </button>\n                                )}\n                            </div>\n\n\n                            {!canEditCustomPolicy ? (\n                                <div className=\"bg-slate-50 dark:bg-slate-950/50 border border-dashed border-slate-200 dark:border-slate-800 rounded-xl p-8 flex flex-col items-center text-center justify-center\">\n                                    <Lock className=\"w-8 h-8 text-slate-300 dark:text-slate-700 mb-3\" />\n                                    <p className=\"text-sm font-medium text-slate-900 dark:text-white mb-1\">Pro Feature</p>\n                                    <button \n                                        onClick={() => setActiveTab('plan')}\n                                        className=\"text-xs font-bold text-brand-600 dark:text-brand-400 underline underline-offset-4\"\n                                    >\n                                        View Plans\n                                    </button>\n                                </div>\n                            ) : (\n                                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-5\">\n                                    {Object.keys(settings.customPolicyDescriptions).length === 0 ? (\n                                        <div className=\"col-span-full text-center py-8 border border-dashed border-slate-200 dark:border-slate-800 rounded-xl\">\n                                            <p className=\"text-[10px] text-slate-500 uppercase font-bold tracking-tight\">No custom policies</p>\n                                        </div>\n                                    ) : (\n                                        Object.entries(settings.customPolicyDescriptions).map(([name, desc]) => {\n                                            const isSelected = settings.selectedCustomPolicies.includes(name);\n                                            return (\n                                                <div \n                                                    key={name}\n                                                    className={`group flex items-start gap-2.5 p-3 rounded-xl border transition-all duration-200 ${\n                                                        isSelected \n                                                        ? 'bg-purple-50/50 dark:bg-purple-900/10 border-purple-200 dark:border-purple-800/50' \n                                                        : 'bg-white dark:bg-slate-950/50 border-slate-200 dark:border-slate-800'\n                                                    }`}\n                                                >\n                                                    <button \n                                                        onClick={() => toggleCustomPolicy(name)}\n                                                        className={`w-4 h-4 rounded flex-shrink-0 border transition-all mt-0.5 ${\n                                                            isSelected \n                                                            ? 'bg-purple-600 border-purple-600' \n                                                            : 'bg-slate-100 dark:bg-slate-800 border-slate-300 dark:border-slate-700'\n                                                        }`}\n                                                    >\n                                                        {isSelected && <Check className=\"w-2.5 h-2.5 text-white mx-auto\" strokeWidth={4} />}\n                                                    </button>\n                                                    \n                                                    <div className=\"flex-1 min-w-0 pointer-events-none sm:pointer-events-auto\" onClick={() => toggleCustomPolicy(name)} style={{cursor: 'pointer'}}>\n                                                        <h4 className={`text-xs font-bold truncate ${isSelected ? 'text-purple-950 dark:text-purple-100' : 'text-slate-900 dark:text-white'}`}>\n                                                            {name}\n                                                        </h4>\n                                                        <p className=\"text-[10px] text-slate-500 dark:text-slate-400 mt-0.5 line-clamp-1\">\n                                                            {desc as string}\n                                                        </p>\n                                                    </div>\n\n                                                    <div className=\"flex items-center gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity\">\n                                                        <button \n                                                            onClick={(e) => {\n                                                                e.stopPropagation();\n                                                                setEditingPolicyName(name);\n                                                                setNewPolicyName(name);\n                                                                const match = (desc as string).match(/^Treat comments with (.*) as (.*)$/);\n                                                                if (match) {\n                                                                    setNewPolicyCondition(match[1]);\n                                                                    setNewPolicyAction(match[2]);\n                                                                } else {\n                                                                    setNewPolicyCondition(desc as string);\n                                                                    setNewPolicyAction('spam');\n                                                                }\n                                                                setIsCustomPolicyFormOpen(true);\n                                                            }}\n                                                            className=\"p-1 text-slate-400 hover:text-brand-600 transition-colors\"\n                                                        >\n                                                            <Edit2 className=\"w-3 h-3\" />\n                                                        </button>\n                                                        <button \n                                                            onClick={(e) => {\n                                                                e.stopPropagation();\n                                                                handleDeleteCustomPolicy(name);\n                                                            }}\n                                                            className=\"p-1 text-slate-400 hover:text-red-500 transition-colors\"\n                                                        >\n                                                            <Trash2 className=\"w-3 h-3\" />\n                                                        </button>\n                                                    </div>\n                                                </div>\n                                            );\n                                        })\n                                    )}\n                                </div>\n                            )}\n                        </div>\n\n                        {/* AI Sensitivity */}\n                        <div className=\"bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 p-6 flex flex-col sm:flex-row items-center justify-between gap-6\">\n                            <div className=\"flex items-center gap-4\">\n                                <div className=\"p-2 bg-brand-50 dark:bg-brand-900/20 rounded-lg text-brand-600 dark:text-brand-400\">\n                                    <Target className=\"w-5 h-5\" />\n                                </div>\n                                <div className=\"flex flex-col\">\n                                    <div className=\"flex items-center gap-2\">\n                                        <label className=\"text-sm font-bold text-slate-900 dark:text-white\">AI Sensitivity</label>\n                                        <div className=\"group relative\">\n                                            <HelpCircle className=\"w-3.5 h-3.5 text-slate-400 hover:text-brand-500 transition-colors cursor-help\" />\n                                            <div className=\"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-64 p-3 bg-slate-800 text-white text-xs rounded-xl shadow-xl opacity-0 scale-95 group-hover:opacity-100 group-hover:scale-100 transition-all pointer-events-none z-50 leading-relaxed font-medium\">\n                                                 <span className=\"text-brand-300 font-bold\">Aggressive:</span> Flags more comments (potential false positives).\n                                                <br/>\n                                                 <span className=\"text-brand-300 font-bold\">Strict:</span> Only flags very obvious violations.\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <p className=\"text-xs text-slate-500 dark:text-slate-400 mt-0.5\">Configure how confident AI must be to flag a comment</p>\n                                </div>\n                                <div className=\"h-8 w-px bg-slate-200 dark:bg-slate-800 mx-2 hidden sm:block\"></div>\n                            </div>\n                                <div className=\"flex bg-slate-100 dark:bg-slate-800 rounded-lg p-1 gap-1\">\n                                    {[\n                                        { label: 'Aggressive', value: 75 },\n                                        { label: 'Balanced', value: 90 },\n                                        { label: 'Strict', value: 99 }\n                                    ].map((option) => {\n                                        const isActive = (\n                                            option.value === 75 && settings.confidenceThreshold < 90\n                                        ) || (\n                                            option.value === 90 && settings.confidenceThreshold >= 90 && settings.confidenceThreshold < 99\n                                        ) || (\n                                            option.value === 99 && settings.confidenceThreshold >= 99\n                                        );\n                                        \n                                        return (\n                                            <button\n                                                key={option.value}\n                                                onClick={() => setSettings({...settings, confidenceThreshold: option.value})}\n                                                className={`\n                                                    px-4 py-1.5 rounded-md text-xs font-bold transition-all\n                                                    ${isActive \n                                                        ? 'bg-white dark:bg-slate-700 text-brand-600 dark:text-brand-400 shadow-sm' \n                                                        : 'text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-300'\n                                                    }\n                                                `}\n                                            >\n                                                {option.label}\n                                            </button>\n                                        );\n                                    })}\n                                </div>\n                        </div>\n\n                        {/* Floating Action Bar - Persistent Save */}\n                        {isDirty && (\n                            <div className=\"fixed bottom-8 right-8 z-50 animate-in slide-in-from-bottom-5 fade-in duration-300\">\n                                <div className=\"bg-slate-900 text-white p-2 pl-5 pr-2 rounded-2xl shadow-2xl shadow-slate-900/40 flex items-center gap-6 border border-slate-700/50\">\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className=\"w-2 h-2 rounded-full bg-amber-400 animate-pulse\"></div>\n                                        <span className=\"text-sm font-medium\">Unsaved changes</span>\n                                    </div>\n                                    <div className=\"flex items-center gap-2\">\n                                        <button \n                                            onClick={handleCancelChanges}\n                                            className=\"px-4 py-2 rounded-xl text-xs font-bold hover:bg-white/10 text-slate-300 hover:text-white transition-colors\"\n                                        >\n                                            Discard\n                                        </button>\n                                        <button \n                                            onClick={handleSaveSettings}\n                                            disabled={isSaving}\n                                            className=\"px-5 py-2 rounded-xl bg-brand-600 hover:bg-brand-500 text-white text-xs font-bold shadow-lg shadow-brand-500/20 transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n                                        >\n                                            {isSaving && <Loader2 className=\"w-3 h-3 animate-spin\" />}\n                                            Save Changes\n                                        </button>\n                                    </div>\n                                </div>\n                            </div>\n                        )}\n                    </div>\n\n                    <div className=\"my-10 border-t border-slate-200 dark:border-slate-800\"></div>\n\n                    {/* Danger Zone */}\n                    <div className=\"bg-red-50/30 dark:bg-red-900/5 rounded-xl border border-red-100 dark:border-red-900/30 p-6\">\n                        <h3 className=\"font-bold text-red-600 dark:text-red-400 flex items-center gap-2 mb-2\">\n                            <Trash2 className=\"w-5 h-5\" /> Danger Zone\n                        </h3>\n                        <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4\">\n                            <div>\n                                <p className=\"text-sm font-semibold text-slate-900 dark:text-white\">Remove Instagram Account</p>\n                                <p className=\"text-xs text-slate-500 dark:text-slate-400 mt-1\">\n                                    Permanently disconnect <span className=\"font-bold\">{currentAccount?.handle}</span>\n                                </p>\n                            </div>\n                            <button \n                                onClick={() => {\n                                    setAccountToDelete(currentAccount);\n                                    setIsDeleteModalOpen(true);\n                                }}\n                                className=\"px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-xs font-bold rounded-lg transition-all shadow-lg shadow-red-500/10\"\n                            >\n                                Remove Account\n                            </button>\n                        </div>\n                    </div>\n\n                    {/* Custom Policy Form Modal */}\n                    {isCustomPolicyFormOpen && (\n                        <div className=\"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-slate-950/40 backdrop-blur-sm\">\n                            <div className=\"bg-white dark:bg-slate-900 w-full max-w-md rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-800 overflow-hidden animate-in fade-in zoom-in duration-200\">\n                                <div className=\"p-6\">\n                                    <div className=\"flex items-center justify-between mb-4\">\n                                        <h3 className=\"text-lg font-bold text-slate-900 dark:text-white\">\n                                            {editingPolicyName ? 'Edit Policy' : 'Create Custom Policy'}\n                                        </h3>\n                                        <button \n                                            onClick={() => setIsCustomPolicyFormOpen(false)}\n                                            className=\"p-1 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200\"\n                                        >\n                                            <AlertCircle className=\"w-5 h-5 rotate-45\" />\n                                        </button>\n                                    </div>\n\n                                    <div className=\"space-y-6\">\n                                        <div>\n                                            <label className=\"block text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1.5\">Policy Name</label>\n                                            <input \n                                                type=\"text\"\n                                                value={newPolicyName}\n                                                onChange={(e) => setNewPolicyName(e.target.value)}\n                                                disabled={!!editingPolicyName}\n                                                placeholder=\"e.g. Scams, Competitors\"\n                                                className=\"w-full px-4 py-2.5 rounded-xl border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-white focus:ring-2 focus:ring-brand-500 focus:border-transparent outline-none disabled:opacity-50\"\n                                            />\n                                        </div>\n                                        \n                                        <div className=\"bg-slate-50 dark:bg-slate-950/50 p-4 rounded-xl border border-slate-200 dark:border-slate-800\">\n                                            <div className=\"flex flex-col gap-3\">\n                                                <div className=\"flex items-center gap-2 text-sm font-medium text-slate-600 dark:text-slate-400\">\n                                                    <span>Treat comments with</span>\n                                                </div>\n                                                <textarea \n                                                    value={newPolicyCondition}\n                                                    onChange={(e) => setNewPolicyCondition(e.target.value)}\n                                                    className=\"w-full h-20 px-4 py-3 rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-brand-500 outline-none resize-none text-sm\"\n                                                />\n                                                <div className=\"flex items-center gap-2 text-sm font-medium text-slate-600 dark:text-slate-400\">\n                                                    <span>as</span>\n                                                    <select \n                                                        value={newPolicyAction}\n                                                        onChange={(e) => setNewPolicyAction(e.target.value)}\n                                                        className=\"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-lg px-2 py-1.5 text-slate-900 dark:text-white focus:ring-2 focus:ring-brand-500 outline-none text-sm font-bold min-w-[120px]\"\n                                                    >\n                                                        <option value=\"spam\">Spam</option>\n                                                        <option value=\"hateSpeech\">Hate Speech</option>\n                                                        <option value=\"harassment\">Harassment</option>\n                                                        <option value=\"violence\">Violence</option>\n                                                        <option value=\"sexualContent\">Sexual Content</option>\n                                                        <option value=\"selfHarm\">Self Harm</option>\n                                                    </select>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    <div className=\"mt-8 flex gap-3\">\n                                        <button onClick={() => setIsCustomPolicyFormOpen(false)} className=\"flex-1 px-4 py-3 rounded-xl font-bold text-sm text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-all\">Cancel</button>\n                                        <button onClick={handleSaveCustomPolicy} disabled={!newPolicyName || !newPolicyCondition || isSaving} className=\"flex-1 px-4 py-3 rounded-xl bg-brand-600 hover:bg-brand-700 text-white font-bold text-sm shadow-brand-500/20 shadow-lg disabled:opacity-50\">\n                                            {isSaving ? 'Saving...' : 'Save Policy'}\n                                        </button>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    )}\n                </div>\n              )}\n\n              {/* --- PLAN & BILLING TAB --- */}\n              {activeTab === 'plan' && (\n                  <div className=\"animate-fade-in max-w-5xl mx-auto\">\n                    \n                    {/* Payment Overlay */}\n                    {isProcessingPayment && (\n                        <div className=\"fixed inset-0 bg-black/50 z-50 flex items-center justify-center backdrop-blur-sm\">\n                            <div className=\"bg-white dark:bg-slate-900 p-8 rounded-2xl shadow-2xl max-w-sm w-full text-center border border-slate-200 dark:border-slate-800\">\n                                <div className=\"w-16 h-16 bg-brand-100 dark:bg-brand-900/30 rounded-full flex items-center justify-center mx-auto mb-6\">\n                                    <RefreshCw className=\"w-8 h-8 text-brand-600 animate-spin\" />\n                                </div>\n                                <h3 className=\"text-xl font-bold text-slate-900 dark:text-white mb-2\">Connecting to Razorpay</h3>\n                                <p className=\"text-slate-500 dark:text-slate-400 text-sm\">\n                                    Securely loading checkout...<br/>Please wait.\n                                </p>\n                            </div>\n                        </div>\n                    )}\n\n                    <div className=\"flex items-center justify-between mb-8\">\n                      <h1 className=\"text-2xl font-bold text-slate-900 dark:text-white\">Plan & Billing</h1>\n                    </div>\n\n                    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12\">\n                        {settings.plan ? (\n                            <>\n                                {/* Active Plan Card */}\n                                <div className=\"bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 p-6 overflow-hidden relative\">\n                                    <div className=\"absolute top-0 right-0 p-4\">\n                                        <div className=\"bg-brand-50 dark:bg-brand-900/40 text-brand-600 dark:text-brand-400 text-xs font-bold px-2 py-1 rounded uppercase tracking-wider\">Active</div>\n                                    </div>\n                                    <div className=\"flex items-start justify-between\">\n                                        <div>\n                                            <p className=\"text-sm text-slate-500 dark:text-slate-400 mb-1\">Current Plan</p>\n                                            <h2 className=\"text-2xl font-bold text-slate-900 dark:text-white mb-4\">{PLANS[settings.plan as PlanType]?.label}</h2>\n                                            <p className=\"text-sm text-slate-500\">\n                                                Renews on <span className=\"font-medium text-slate-700 dark:text-slate-300\">Jan 12, 2026</span>\n                                            </p>\n                                        </div>\n                                        <div className=\"text-right\">\n                                            <p className=\"text-2xl font-bold text-slate-900 dark:text-white\">\n                                                {currency === 'INR' ? '' : '$'}{PLANS[settings.plan as PlanType]?.price}\n                                                <span className=\"text-sm font-normal text-slate-500\">/mo</span>\n                                            </p>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                {/* Payment Method Card (Simplified Mock) */}\n                                <div className=\"bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 p-6\">\n                                    <h2 className=\"text-lg font-semibold text-slate-900 dark:text-white mb-6\">Payment Method</h2>\n                                    <div className=\"flex items-center gap-4 mb-6\">\n                                        <div className=\"w-12 h-8 bg-slate-100 dark:bg-slate-800 rounded flex items-center justify-center border border-slate-200 dark:border-slate-700\">\n                                            <div className=\"font-bold text-blue-600 italic text-xs\">VISA</div>\n                                        </div>\n                                        <div>\n                                            <p className=\"text-sm font-medium text-slate-900 dark:text-white\">Visa ending in 4242</p>\n                                            <p className=\"text-xs text-slate-500\">Expires 12/2028</p>\n                                        </div>\n                                    </div>\n                                    <button className=\"w-full py-2 text-sm text-slate-600 dark:text-slate-300 border border-slate-300 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors\">\n                                        Update Payment Method\n                                    </button>\n                                </div>\n                            </>\n                        ) : (\n                            <div className=\"lg:col-span-2 bg-gradient-to-br from-brand-600 to-indigo-700 rounded-2xl shadow-xl p-8 text-white relative overflow-hidden\">\n                                <div className=\"relative z-10\">\n                                    <h2 className=\"text-3xl font-bold mb-4\">Welcome to ShieldGram!</h2>\n                                    <p className=\"text-lg opacity-90 max-w-2xl mb-6\">\n                                        To start protecting your Instagram account with AI-powered moderation, please select a protection plan below.\n                                        Our plans include a 30-day money-back guarantee.\n                                    </p>\n                                    <div className=\"flex items-center gap-4 text-sm font-medium\">\n                                        <div className=\"flex items-center gap-1 bg-white/10 px-3 py-1.5 rounded-full\">\n                                            <Shield className=\"w-4 h-4\" /> 24/7 Protection\n                                        </div>\n                                        <div className=\"flex items-center gap-1 bg-white/10 px-3 py-1.5 rounded-full\">\n                                            <Zap className=\"w-4 h-4\" /> Real-time Blocking\n                                        </div>\n                                    </div>\n                                </div>\n                                <Shield className=\"absolute -bottom-10 -right-10 w-64 h-64 opacity-10 rotate-12\" />\n                            </div>\n                        )}\n                    </div>\n\n                    {/* Available Plans */}\n                    <h2 className=\"text-xl font-bold text-slate-900 dark:text-white mb-6\">Available Plans</h2>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                        {(Object.keys(PLANS) as PlanType[]).map((planKey) => {\n                            const plan = PLANS[planKey];\n                            const isCurrent = settings.plan === planKey;\n                            \n                            // Dynamic Pricing Logic\n                            const currencySymbol = currency === 'INR' ? '' : '$';\n                            let displayPrice: string | number = \"--\"; \n                            \n                            const dynamicPlan = razorpayPlans.find(p => \n                                p.name.toLowerCase().includes(plan.label.toLowerCase()) && \n                                p.currency === currency\n                            );\n\n                            if (dynamicPlan) {\n                                displayPrice = dynamicPlan.amount / 100;\n                            }\n                            // If no dynamicPlan found, displayPrice remains \"--\"\n                            \n                            const currentPlanData = razorpayPlans.find(p => \n                                p.name.toLowerCase().includes(PLANS[settings.plan]?.label?.toLowerCase() || '') && \n                                p.currency === currency\n                            );\n                            const currentPlanPrice = currentPlanData?.amount || 0;\n\n                            // Can only determine upgrade/downgrade if we have real prices\n                            const isUpgrade = typeof displayPrice === 'number' && (displayPrice * 100) > currentPlanPrice;\n\n                            return (\n                                <div \n                                    key={planKey} \n                                    className={`relative flex flex-col p-6 rounded-xl border transition-all ${\n                                        isCurrent \n                                        ? 'bg-brand-50/50 dark:bg-brand-900/10 border-brand-200 dark:border-brand-800 ring-1 ring-brand-500 dark:ring-brand-400' \n                                        : 'bg-white dark:bg-slate-900 border-slate-200 dark:border-slate-800 hover:border-brand-300 dark:hover:border-brand-700 hover:shadow-md'\n                                    }`}\n                                >\n                                    {isCurrent && (\n                                        <div className=\"absolute top-0 right-0 -mt-3 -mr-3\">\n                                            <span className=\"flex h-6 w-6 items-center justify-center rounded-full bg-brand-600 text-white shadow-sm\">\n                                                <Check className=\"w-4 h-4\" />\n                                            </span>\n                                        </div>\n                                    )}\n\n                                    <h3 className=\"text-lg font-bold text-slate-900 dark:text-white capitalize\">{plan.label}</h3>\n                                    <div className=\"mt-2 mb-6\">\n                                        <span className=\"text-3xl font-bold text-slate-900 dark:text-white\">{currencySymbol}{displayPrice}</span>\n                                        <span className=\"text-slate-500 text-sm\">/mo</span>\n                                    </div>\n\n                                    <ul className=\"space-y-3 mb-8 flex-1\">\n                                        {plan.features.map((feature, i) => (\n                                            <li key={i} className=\"flex items-start gap-2 text-sm text-slate-600 dark:text-slate-400\">\n                                                <CheckCircle className=\"w-4 h-4 text-green-500 shrink-0 mt-0.5\" />\n                                                {feature}\n                                            </li>\n                                        ))}\n                                    </ul>\n\n                                    <button\n                                        onClick={() => handleChangePlan(planKey)}\n                                        disabled={isCurrent || isProcessingPayment}\n                                        className={`w-full py-2.5 px-4 rounded-lg font-medium transition-colors text-sm ${\n                                            isCurrent \n                                            ? 'bg-brand-100 text-brand-700 dark:bg-brand-900/30 dark:text-brand-300 cursor-default'\n                                            : isUpgrade\n                                                ? 'bg-slate-900 dark:bg-white text-white dark:text-slate-900 hover:bg-slate-800 dark:hover:bg-slate-100 shadow-sm'\n                                                : 'bg-white dark:bg-slate-900 text-slate-600 dark:text-slate-400 border border-slate-300 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800'\n                                        }`}\n                                    >\n                                        {isCurrent ? 'Current Plan' : isUpgrade ? 'Upgrade' : 'Downgrade'}\n                                    </button>\n                                </div>\n                            );\n                        })}\n                    </div>\n\n                    {/* Billing History */}\n                    <div className=\"mt-12 bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden\">\n                        <div className=\"p-6 border-b border-slate-200 dark:border-slate-800\">\n                            <h2 className=\"text-lg font-semibold text-slate-900 dark:text-white\">Billing History</h2>\n                        </div>\n                        <div className=\"overflow-x-auto\">\n                            <table className=\"w-full text-left text-sm\">\n                                <thead className=\"bg-slate-50 dark:bg-slate-800/50 text-slate-500 dark:text-slate-400\">\n                                    <tr>\n                                        <th className=\"px-6 py-4 font-medium\">Date</th>\n                                        <th className=\"px-6 py-4 font-medium\">Amount</th>\n                                        <th className=\"px-6 py-4 font-medium\">Status</th>\n                                        <th className=\"px-6 py-4 font-medium text-right\">Invoice</th>\n                                    </tr>\n                                </thead>\n                                <tbody className=\"divide-y divide-slate-100 dark:divide-slate-800\">\n                                    <tr className=\"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors\">\n                                        <td className=\"px-6 py-4 text-slate-900 dark:text-slate-300\">Oct 12, 2024</td>\n                                        <td className=\"px-6 py-4 text-slate-600 dark:text-slate-400\">$5.00</td>\n                                        <td className=\"px-6 py-4\">\n                                            <span className=\"inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 border border-green-200 dark:border-green-800\">\n                                                Paid\n                                            </span>\n                                        </td>\n                                        <td className=\"px-6 py-4 text-right\">\n                                            <button className=\"text-brand-600 dark:text-brand-400 hover:underline flex items-center gap-1 justify-end ml-auto\">\n                                                <Download className=\"w-4 h-4\" /> PDF\n                                            </button>\n                                        </td>\n                                    </tr>\n                                     <tr className=\"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors\">\n                                        <td className=\"px-6 py-4 text-slate-900 dark:text-slate-300\">Sep 12, 2024</td>\n                                        <td className=\"px-6 py-4 text-slate-600 dark:text-slate-400\">$5.00</td>\n                                        <td className=\"px-6 py-4\">\n                                            <span className=\"inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 border border-green-200 dark:border-green-800\">\n                                                Paid\n                                            </span>\n                                        </td>\n                                        <td className=\"px-6 py-4 text-right\">\n                                            <button className=\"text-brand-600 dark:text-brand-400 hover:underline flex items-center gap-1 justify-end ml-auto\">\n                                                <Download className=\"w-4 h-4\" /> PDF\n                                            </button>\n                                        </td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </div>\n                    </div>\n                  </div>\n              )}\n\n              {/* --- SECURITY TAB --- */}\n              {activeTab === 'security' && (\n                  <div className=\"animate-fade-in max-w-2xl mx-auto\">\n                    <div className=\"flex items-center justify-between mb-8\">\n                        <h1 className=\"text-2xl font-bold text-slate-900 dark:text-white\">Security Settings</h1>\n                    </div>\n\n                    {/* MFA Status Card - Hidden when setup wizard is active */}\n                    {!isMFASetupOpen && (\n                    <div className=\"bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 p-8\">\n                        <div className=\"flex items-center gap-4 mb-8\">\n                            <div className={`w-12 h-12 rounded-xl flex items-center justify-center ${mfaStatus ? 'bg-green-50 dark:bg-green-900/20 text-green-600' : 'bg-slate-50 dark:bg-slate-800 text-slate-400'}`}>\n                                <ShieldCheck className=\"w-6 h-6\" />\n                            </div>\n                            <div>\n                                <h3 className=\"text-lg font-bold text-slate-900 dark:text-white\">Multi-Factor Authentication (MFA)</h3>\n                                <p className=\"text-slate-500 dark:text-slate-400 text-sm mt-1\">\n                                    Secure your account with an extra layer of protection using your preferred authenticator app.\n                                </p>\n                            </div>\n                        </div>\n\n                        {!mfaStatus ? (\n                            <div className=\"flex flex-col items-center py-6 text-center\">\n                                <Lock className=\"w-12 h-12 text-slate-200 dark:text-slate-800 mb-4\" />\n                                <h4 className=\"font-semibold text-slate-900 dark:text-white mb-2\">Authenticator App is Not Active</h4>\n                                <p className=\"text-slate-500 dark:text-slate-400 text-sm max-w-md mb-8\">\n                                    We recommend enabling MFA to protect your account from unauthorized access. You'll need an app like Google Authenticator or Authy.\n                                </p>\n                                <button \n                                    onClick={handleEnableMFA}\n                                    disabled={isMFAInitLoading}\n                                    className=\"px-6 py-2.5 bg-brand-600 hover:bg-brand-700 text-white font-semibold rounded-xl shadow-lg shadow-brand-500/20 transition-all flex items-center gap-2 disabled:opacity-50\"\n                                >\n                                    {isMFAInitLoading ? <Loader2 className=\"w-4 h-4 animate-spin text-white\" /> : <ShieldCheck className=\"w-4 h-4\" />}\n                                    Enable MFA\n                                </button>\n                            </div>\n                        ) : (\n                            <div className=\"flex flex-col border border-slate-100 dark:border-slate-800 rounded-xl p-6 bg-slate-50/50 dark:bg-slate-950/20\">\n                                <div className=\"flex items-center justify-between mb-6\">\n                                    <div className=\"flex items-center gap-3\">\n                                        <div className=\"w-3 h-3 bg-green-500 rounded-full animate-pulse\"></div>\n                                        <span className=\"text-sm font-bold text-green-600 dark:text-green-400 uppercase tracking-wider\">Active Protection</span>\n                                    </div>\n                                    <button \n                                        onClick={handleDisableMFA}\n                                        className=\"text-xs text-red-600 dark:text-red-400 font-bold hover:underline\"\n                                    >\n                                        Disable MFA\n                                    </button>\n                                </div>\n                                <div className=\"flex items-start gap-4\">\n                                    <CheckCircle className=\"w-5 h-5 text-green-500 shrink-0 mt-0.5\" />\n                                    <div className=\"text-sm text-slate-600 dark:text-slate-400 leading-relaxed\">\n                                        Your account is secured with 2FA. Every time you log in, you will be prompted for a 6-digit code from your authenticator app.\n                                    </div>\n                                </div>\n                            </div>\n                        )}\n                    </div>\n                    )}\n\n                    {/* MFA Setup Step-by-Step UI - Full width when active */}\n                    {isMFASetupOpen && mfaSecret && (\n                        <div className=\"bg-white dark:bg-slate-900 rounded-2xl shadow-xl border-2 border-brand-500 dark:border-brand-500/50 p-8 animate-in slide-in-from-top-4 duration-300\">\n                            <h3 className=\"text-xl font-bold text-slate-900 dark:text-white mb-6\">Configure Authenticator App</h3>\n                            \n                            <div className=\"space-y-8\">\n                                <div className=\"flex gap-4\">\n                                    <div className=\"flex-shrink-0 w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 flex items-center justify-center font-bold text-sm border border-slate-200 dark:border-slate-700\">1</div>\n                                    <div>\n                                        <h4 className=\"font-bold text-slate-900 dark:text-white mb-2\">Scan or Enter Secret</h4>\n                                        <p className=\"text-sm text-slate-500 dark:text-slate-400 mb-4\">\n                                            Open your authenticator app (Google Authenticator, Authy, etc.) and scan the QR code below, or enter the secret manually.\n                                        </p>\n                                        <div className=\"bg-slate-50 dark:bg-slate-950 p-4 rounded-xl border border-slate-100 dark:border-slate-800 inline-block\">\n                                            {/* QR Code Placeholder - using a service for demo or just instructions */}\n                                            <div className=\"w-48 h-48 bg-white dark:bg-slate-900 rounded-lg flex items-center justify-center border border-slate-200 dark:border-slate-700 mb-4\">\n                                                <img \n                                                    src={`https://quickchart.io/qr?text=${encodeURIComponent(`otpauth://totp/ShieldGram?secret=${mfaSecret}&issuer=ShieldGram`)}&size=200`} \n                                                    alt=\"QR Code\" \n                                                    className=\"w-full h-full p-2\"\n                                                />\n                                            </div>\n                                            <div className=\"text-center\">\n                                                <p className=\"text-[10px] text-slate-400 uppercase font-black tracking-widest mb-1\">Manual Entry Code</p>\n                                                <code className=\"text-sm font-mono text-brand-600 dark:text-brand-400 break-all bg-brand-50 dark:bg-brand-900/20 px-2 py-1 rounded select-all font-bold\">\n                                                    {mfaSecret}\n                                                </code>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div className=\"flex gap-4\">\n                                    <div className=\"flex-shrink-0 w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 flex items-center justify-center font-bold text-sm border border-slate-200 dark:border-slate-700\">2</div>\n                                    <div className=\"flex-grow\">\n                                        <h4 className=\"font-bold text-slate-900 dark:text-white mb-2\">Verify Code</h4>\n                                        <p className=\"text-sm text-slate-500 dark:text-slate-400 mb-4\">\n                                            Enter the 6-digit code currently shown in your app to confirm setup.\n                                        </p>\n                                        <div className=\"flex gap-2\">\n                                            <input \n                                                type=\"text\"\n                                                maxLength={6}\n                                                value={mfaVerificationCode}\n                                                onChange={(e) => setMfaVerificationCode(e.target.value.replace(/[^0-9]/g, ''))}\n                                                className=\"w-full sm:w-48 px-4 py-3 bg-slate-50 dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-700 rounded-xl focus:border-brand-500 focus:ring-4 focus:ring-brand-500/10 outline-none transition-all text-center text-2xl font-bold tracking-[0.5em] text-slate-900 dark:text-white\"\n                                                placeholder=\"000000\"\n                                            />\n                                            <button \n                                                onClick={handleVerifyMFA}\n                                                disabled={isMFAVerifyLoading || mfaVerificationCode.length !== 6}\n                                                className=\"px-6 py-3 bg-brand-600 hover:bg-brand-700 text-white font-black rounded-xl shadow-lg shadow-brand-500/20 transition-all flex items-center gap-2 disabled:opacity-50 uppercase text-xs\"\n                                            >\n                                                {isMFAVerifyLoading ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : \"Verify & Finish\"}\n                                            </button>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            \n                            <div className=\"mt-10 pt-6 border-t border-slate-100 dark:border-slate-800 flex justify-end\">\n                                <button \n                                    onClick={() => {\n                                        setIsMFASetupOpen(false);\n                                        setMfaSecret(null);\n                                        setMfaVerificationCode('');\n                                    }}\n                                    className=\"text-sm font-bold text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white transition-colors\"\n                                >\n                                    Cancel Setup\n                                </button>\n                            </div>\n                        </div>\n                    )}\n                  </div>\n              )}\n            </>\n          )}\n        </div>\n      </main>\n\n      {/* Account Deletion Confirmation Modal */}\n      {isDeleteModalOpen && accountToDelete && (\n        <div className=\"fixed inset-0 z-[110] flex items-center justify-center p-4 bg-slate-950/60 backdrop-blur-sm animate-in fade-in duration-200\">\n          <div className=\"bg-white dark:bg-slate-900 w-full max-w-sm rounded-2xl shadow-2xl border border-slate-200 dark:border-slate-800 overflow-hidden animate-in zoom-in-95 duration-200\">\n            <div className=\"p-6 text-center\">\n              <div className=\"w-16 h-16 bg-red-50 dark:bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-4 text-red-600\">\n                <Trash2 className=\"w-8 h-8\" />\n              </div>\n              <h3 className=\"text-xl font-bold text-slate-900 dark:text-white mb-2\">Remove Account?</h3>\n              <p className=\"text-slate-500 dark:text-slate-400 text-sm mb-6\">\n                Are you sure you want to remove <span className=\"font-bold text-slate-900 dark:text-white\">{accountToDelete.handle}</span>? \n                All associated moderation history and statistics will be permanently deleted.\n              </p>\n              \n              <div className=\"flex flex-col gap-3\">\n                <button \n                  onClick={handleDeleteAccount}\n                  disabled={isSaving}\n                  className=\"w-full py-3 bg-red-600 hover:bg-red-700 text-white font-bold rounded-xl shadow-lg shadow-red-500/20 transition-all disabled:opacity-50\"\n                >\n                  {isSaving ? 'Removing...' : 'Yes, Remove Account'}\n                </button>\n                <button \n                  onClick={() => {\n                    setIsDeleteModalOpen(false);\n                    setAccountToDelete(null);\n                  }}\n                  disabled={isSaving}\n                  className=\"w-full py-3 text-slate-600 dark:text-slate-400 font-bold hover:bg-slate-50 dark:hover:bg-slate-800 rounded-xl transition-all\"\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Dashboard;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4866, "column": 0}, "map": {"version":3,"sources":["file:///Users/cauldronpumpkin/Documents/infloo/shieldgram-frontend/components/AuthPage.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { ArrowRight, Loader2, CheckCircle2, RefreshCw } from 'lucide-react';\n// @ts-ignore - Importing from esm.sh\nimport { CognitoUserPool, CognitoUser, AuthenticationDetails } from 'amazon-cognito-identity-js';\nimport { setAuthTokens } from '../utils/auth';\n// import logo from '../logo.svg'; // Uses public path now\n  \ninterface AuthPageProps {\n  onLoginSuccess: () => void;\n  onCancel: () => void;\n}\n\n// =========================================================================\n// AWS COGNITO BOILERPLATE CONFIGURATION\n// Configured to use Environment Variables for easy Amplify Deployment\n// =========================================================================\nconst COGNITO_CONFIG = {\n  UserPoolId: process.env.NEXT_PUBLIC_COGNITO_USER_POOL_ID, \n  ClientId: process.env.NEXT_PUBLIC_COGNITO_CLIENT_ID\n};\ntype AuthMode = 'signin' | 'signup' | 'verify' | 'totp';\n\nconst AuthPage: React.FC<AuthPageProps> = ({ onLoginSuccess, onCancel }) => {\n  const [authMode, setAuthMode] = useState<AuthMode>('signin');\n  const [isLoading, setIsLoading] = useState(false);\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [verificationCode, setVerificationCode] = useState('');\n  const [error, setError] = useState<string | null>(null);\n  const [successMessage, setSuccessMessage] = useState<string | null>(null);\n  const [cognitoUserRef, setCognitoUserRef] = useState<any>(null);\n\n  // Check if we are running in mock mode (if env vars are missing or placeholders)\n  const isMockMode = !COGNITO_CONFIG.UserPoolId || COGNITO_CONFIG.UserPoolId.includes('xxx');\n\n  // Safe initialization of User Pool\n  let userPool: any = null;\n  if (!isMockMode) {\n    try {\n      userPool = new CognitoUserPool({\n        UserPoolId: COGNITO_CONFIG.UserPoolId,\n        ClientId: COGNITO_CONFIG.ClientId,\n      });\n    } catch (e) {\n      console.error(\"Error initializing Cognito User Pool:\", e);\n    }\n  }\n\n  const handleSignup = (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError(null);\n\n    if (isMockMode) {\n         console.warn('AWS Cognito Config missing or using placeholders. Using mock signup for demo.');\n         setTimeout(() => {\n             setIsLoading(false);\n             setAuthMode('verify');\n             setSuccessMessage('Mock verification code sent! (Use any code)');\n         }, 1000);\n         return;\n    }\n\n    if (!userPool) return;\n\n    userPool.signUp(email, password, [], [], (err: any, result: any) => {\n      setIsLoading(false);\n      if (err) {\n        console.error(err);\n        setError(err.message || JSON.stringify(err));\n        return;\n      }\n      setAuthMode('verify');\n      setSuccessMessage('Account created! Please check your email for the verification code.');\n    });\n  };\n\n  const handleVerify = (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError(null);\n    setSuccessMessage(null);\n\n    if (isMockMode) {\n        setTimeout(() => {\n            setIsLoading(false);\n            setAuthMode('signin');\n            setSuccessMessage('Account verified! Please sign in.');\n            setVerificationCode('');\n        }, 1000);\n        return;\n    }\n\n    const cognitoUser = new CognitoUser({\n        Username: email,\n        Pool: userPool,\n    });\n\n    cognitoUser.confirmRegistration(verificationCode, true, (err: any, result: any) => {\n        setIsLoading(false);\n        if (err) {\n            console.error(err);\n            setError(err.message || 'Verification failed');\n            return;\n        }\n        setAuthMode('signin');\n        setSuccessMessage('Verification successful! You can now log in.');\n        setVerificationCode('');\n    });\n  };\n\n  const handleResendCode = () => {\n      if (isMockMode) {\n          setSuccessMessage('Mock code resent!');\n          return;\n      }\n\n      const cognitoUser = new CognitoUser({\n        Username: email,\n        Pool: userPool,\n    });\n\n    cognitoUser.resendConfirmationCode((err: any, result: any) => {\n        if (err) {\n            setError(err.message || 'Failed to resend code');\n            return;\n        }\n        setSuccessMessage('Verification code resent successfully.');\n    });\n  };\n\n  const handleLogin = (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError(null);\n\n    if (isMockMode) {\n         console.warn('AWS Cognito Config missing or using placeholders. Using mock login for demo.');\n         setTimeout(() => {\n          setAuthTokens({ \n              accessToken: 'shieldgram-dummy-access-token',\n              idToken: 'shieldgram-dummy-id-token',\n              refreshToken: 'shieldgram-dummy-refresh-token'\n          });\n          setIsLoading(false);\n          onLoginSuccess();\n         }, 1000);\n         return;\n    }\n\n    const authenticationDetails = new AuthenticationDetails({\n      Username: email,\n      Password: password,\n    });\n\n    const cognitoUser = new CognitoUser({\n      Username: email,\n      Pool: userPool,\n    });\n\n    cognitoUser.authenticateUser(authenticationDetails, {\n      onSuccess: (result: any) => {\n        setIsLoading(false);\n        setAuthTokens({\n          accessToken: result.getAccessToken().getJwtToken(),\n          idToken: result.getIdToken().getJwtToken(),\n          refreshToken: result.getRefreshToken().getToken()\n        });\n        onLoginSuccess();\n      },\n      onFailure: (err: any) => {\n        setIsLoading(false);\n        console.error(err);\n        setError(err.message || 'Authentication failed');\n      },\n      totpRequired: (session: any) => {\n        setIsLoading(false);\n        setCognitoUserRef(cognitoUser); // Save user instance for verification\n        setAuthMode('totp');\n      },\n      newPasswordRequired: (userAttributes: any, requiredAttributes: any) => {\n        setIsLoading(false);\n        setError(\"New password required (Challenge not implemented in boilerplate)\");\n      }\n    });\n  };\n\n  const handleTOTPSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError(null);\n\n    if (isMockMode) {\n        setTimeout(() => {\n            setAuthTokens({ \n                accessToken: 'shieldgram-dummy-access-token',\n                idToken: 'shieldgram-dummy-id-token',\n                refreshToken: 'shieldgram-dummy-refresh-token'\n            });\n            setIsLoading(false);\n            onLoginSuccess();\n        }, 1000);\n        return;\n    }\n\n    if (!cognitoUserRef) {\n        setError(\"Authentication session lost. Please try signing in again.\");\n        setAuthMode('signin');\n        setIsLoading(false);\n        return;\n    }\n\n    cognitoUserRef.sendMFACode(verificationCode, {\n        onSuccess: (result: any) => {\n            setIsLoading(false);\n            setAuthTokens({\n                accessToken: result.getAccessToken().getJwtToken(),\n                idToken: result.getIdToken().getJwtToken(),\n                refreshToken: result.getRefreshToken().getToken()\n            });\n            onLoginSuccess();\n        },\n        onFailure: (err: any) => {\n            setIsLoading(false);\n            console.error(err);\n            setError(err.message || 'Verification failed');\n        }\n    }, 'SOFTWARE_TOKEN_MFA');\n  };\n\n  const getTitle = () => {\n      switch(authMode) {\n          case 'signin': return 'Welcome back';\n          case 'signup': return 'Create an account';\n          case 'verify': return 'Verify email';\n          case 'totp': return 'Security Check';\n      }\n  };\n\n  const getSubtitle = () => {\n      switch(authMode) {\n          case 'signin': return 'Sign in to access your dashboard';\n          case 'signup': return 'Start your 1-month free trial';\n          case 'verify': return 'Enter the code sent to your email';\n          case 'totp': return 'Enter the 6-digit code from your authenticator app';\n      }\n  };\n\n  return (\n    <div className=\"min-h-screen flex flex-col items-center justify-center bg-slate-50 dark:bg-slate-950 px-4 py-12 transition-colors duration-300\">\n      <div className=\"w-full max-w-md bg-white dark:bg-slate-900 rounded-2xl shadow-xl border border-slate-200 dark:border-slate-800 p-8\">\n        <div className=\"flex justify-center mb-8\">\n            <img src=\"/logo.svg\" alt=\"ShieldGram\" className=\"h-16 w-auto\" />\n        </div>\n\n        <h2 className=\"text-center text-2xl font-bold text-slate-900 dark:text-white mb-2\">\n          {getTitle()}\n        </h2>\n        <p className=\"text-center text-slate-600 dark:text-slate-400 mb-8\">\n          {getSubtitle()}\n        </p>\n\n        {error && (\n            <div className=\"mb-4 p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm rounded-lg border border-red-100 dark:border-red-800 animate-fade-in\">\n                {error}\n            </div>\n        )}\n\n        {successMessage && (\n            <div className=\"mb-4 p-3 bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 text-sm rounded-lg border border-green-100 dark:border-green-800 flex items-center gap-2 animate-fade-in\">\n                <CheckCircle2 className=\"w-4 h-4\" />\n                {successMessage}\n            </div>\n        )}\n\n        <form onSubmit={\n            authMode === 'signin' ? handleLogin : \n            authMode === 'signup' ? handleSignup : \n            authMode === 'verify' ? handleVerify : \n            handleTOTPSubmit\n        } className=\"space-y-4\">\n          \n          {authMode !== 'verify' && authMode !== 'totp' && (\n             <>\n                <div>\n                    <label className=\"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1\">Email Address</label>\n                    <input \n                    type=\"email\" \n                    required\n                    value={email}\n                    onChange={(e) => setEmail(e.target.value)}\n                    className=\"w-full px-4 py-3 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-brand-500 outline-none transition-all dark:text-white\"\n                    placeholder=\"name@company.com\"\n                    />\n                </div>\n\n                <div>\n                    <label className=\"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1\">Password</label>\n                    <input \n                    type=\"password\" \n                    required\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    className=\"w-full px-4 py-3 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-brand-500 outline-none transition-all dark:text-white\"\n                    placeholder=\"\"\n                    />\n                    {authMode === 'signup' && (\n                        <p className=\"text-xs text-slate-500 mt-1\">Must be at least 8 characters with numbers and symbols.</p>\n                    )}\n                </div>\n             </>\n          )}\n\n          {(authMode === 'verify' || authMode === 'totp') && (\n              <div>\n                <label className=\"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1\">\n                  {authMode === 'verify' ? 'Email Verification Code' : 'Authenticator App Code'}\n                </label>\n                <input \n                  type=\"text\" \n                  required\n                  value={verificationCode}\n                  onChange={(e) => setVerificationCode(e.target.value)}\n                  className=\"w-full px-4 py-3 rounded-lg bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 focus:ring-2 focus:ring-brand-500 outline-none transition-all dark:text-white text-center text-xl tracking-widest\"\n                  placeholder=\"123456\"\n                />\n                {authMode === 'verify' && (\n                  <div className=\"flex justify-end mt-2\">\n                    <button \n                        type=\"button\" \n                        onClick={handleResendCode}\n                        className=\"text-sm text-brand-600 dark:text-brand-400 hover:underline flex items-center gap-1\"\n                    >\n                        <RefreshCw className=\"w-3 h-3\" /> Resend Code\n                    </button>\n                  </div>\n                )}\n              </div>\n          )}\n\n          <button \n            type=\"submit\" \n            disabled={isLoading}\n            className=\"w-full py-3 px-4 bg-brand-600 hover:bg-brand-700 text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed mt-6\"\n          >\n            {isLoading ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : \n                authMode === 'signin' ? 'Sign In' : \n                authMode === 'signup' ? 'Create Account' : \n                authMode === 'verify' ? 'Verify Account' :\n                'Verify & Login'\n            }\n            {!isLoading && <ArrowRight className=\"w-4 h-4\" />}\n          </button>\n          \n          {authMode === 'signup' && (\n            <p className=\"mt-4 text-[10px] text-center text-slate-500 leading-relaxed uppercase tracking-wider\">\n              By creating an account, you agree to our{' '}\n              <a href=\"#/terms\" target=\"_blank\" className=\"text-brand-600 hover:text-brand-500 font-bold underline\">Terms of Service</a>\n              {' '}and{' '}\n              <a href=\"#/privacy\" target=\"_blank\" className=\"text-brand-600 hover:text-brand-500 font-bold underline\">Privacy Policy</a>\n            </p>\n          )}\n        </form>\n\n        <div className=\"mt-6 text-center\">\n          <p className=\"text-sm text-slate-600 dark:text-slate-400\">\n            {authMode === 'signin' ? \"Don't have an account? \" : \n             authMode === 'signup' ? \"Already have an account? \" : \n             \"Wrong email? \"}\n            \n            <button \n              onClick={() => {\n                  setError(null);\n                  setSuccessMessage(null);\n                  if (authMode === 'verify' || authMode === 'totp') {\n                      setAuthMode('signin');\n                  } else {\n                      setAuthMode(authMode === 'signin' ? 'signup' : 'signin');\n                  }\n              }}\n              className=\"text-brand-600 dark:text-brand-400 font-semibold hover:underline\"\n            >\n              {authMode === 'signin' ? 'Sign up' : \n               authMode === 'signup' ? 'Log in' : \n               'Back'}\n            </button>\n          </p>\n        </div>\n        \n        <div className=\"mt-8 pt-6 border-t border-slate-100 dark:border-slate-800 text-center\">\n          <button onClick={onCancel} className=\"text-sm text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-colors\">\n            Return to Home\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AuthPage;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5424, "column": 0}, "map": {"version":3,"sources":["file:///Users/cauldronpumpkin/Documents/infloo/shieldgram-frontend/app/dashboard/page.tsx"],"sourcesContent":["'use client';\n\nimport React, { useState, useEffect } from 'react';\nimport Dashboard from '@/components/Dashboard';\nimport AuthPage from '@/components/AuthPage';\nimport { getValidToken, getPlans } from '@/services/dashboardService';\nimport { removeAuthToken, getThemeCookie, setThemeCookie } from '@/utils/auth';\n\nexport default function DashboardPage() {\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isDarkMode, setIsDarkMode] = useState(false);\n\n  // Initialize Theme (duplicated logic, should be in context)\n  useEffect(() => {\n    const savedTheme = typeof window !== 'undefined' ? (getThemeCookie() || localStorage.getItem('theme')) : null;\n    if (savedTheme === 'dark') {\n      setIsDarkMode(true);\n      document.documentElement.classList.add('dark');\n    } else {\n      setIsDarkMode(false);\n      document.documentElement.classList.remove('dark');\n    }\n  }, []);\n\n  const toggleTheme = () => {\n      const newMode = !isDarkMode;\n      setIsDarkMode(newMode);\n      const theme = newMode ? 'dark' : 'light';\n      if (newMode) document.documentElement.classList.add('dark');\n      else document.documentElement.classList.remove('dark');\n      localStorage.setItem('theme', theme);\n      setThemeCookie(theme);\n  };\n\n  useEffect(() => {\n    const checkAuth = async () => {\n      try {\n        await getValidToken();\n        setIsLoggedIn(true);\n      } catch (err) {\n        setIsLoggedIn(false);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    checkAuth();\n  }, []);\n\n  const handleLoginSuccess = () => {\n    setIsLoggedIn(true);\n    window.location.reload();\n  };\n\n  const handleLogout = () => {\n    removeAuthToken();\n    setIsLoggedIn(false);\n    window.location.href = '/'; // Go to landing page\n  };\n\n  if (isLoading) {\n    return <div className=\"min-h-screen bg-slate-50 dark:bg-slate-950 flex items-center justify-center\">Loading...</div>;\n  }\n\n  if (!isLoggedIn) {\n     return (\n        <div className={`min-h-screen ${isDarkMode ? 'dark' : ''}`}>\n           <AuthPage \n              onLoginSuccess={handleLoginSuccess} \n              onCancel={() => window.location.href = '/'} \n           />\n        </div>\n     );\n  }\n\n  return (\n    <div className={`min-h-screen ${isDarkMode ? 'dark' : ''}`}>\n        <Dashboard \n            onLogout={handleLogout}\n            isDarkMode={isDarkMode}\n            toggleTheme={toggleTheme}\n        />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAQe,SAAS;IACtB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,4DAA4D;IAC5D,IAAA,kNAAS,EAAC;QACR,MAAM,aAAa,sCAAgC,0BAAsD;QACzG;;aAGO;YACL,cAAc;YACd,SAAS,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC;QAC5C;IACF,GAAG,EAAE;IAEL,MAAM,cAAc;QAChB,MAAM,UAAU,CAAC;QACjB,cAAc;QACd,MAAM,QAAQ,UAAU,SAAS;QACjC,IAAI,SAAS,SAAS,eAAe,CAAC,SAAS,CAAC,GAAG,CAAC;aAC/C,SAAS,eAAe,CAAC,SAAS,CAAC,MAAM,CAAC;QAC/C,aAAa,OAAO,CAAC,SAAS;QAC9B,IAAA,+HAAc,EAAC;IACnB;IAEA,IAAA,kNAAS,EAAC;QACR,MAAM,YAAY;YAChB,IAAI;gBACF,MAAM,IAAA,6IAAa;gBACnB,cAAc;YAChB,EAAE,OAAO,KAAK;gBACZ,cAAc;YAChB,SAAU;gBACR,aAAa;YACf;QACF;QACA;IACF,GAAG,EAAE;IAEL,MAAM,qBAAqB;QACzB,cAAc;QACd,OAAO,QAAQ,CAAC,MAAM;IACxB;IAEA,MAAM,eAAe;QACnB,IAAA,gIAAe;QACf,cAAc;QACd,OAAO,QAAQ,CAAC,IAAI,GAAG,KAAK,qBAAqB;IACnD;IAEA,IAAI,WAAW;QACb,qBAAO,8OAAC;YAAI,WAAU;sBAA8E;;;;;;IACtG;IAEA,IAAI,CAAC,YAAY;QACd,qBACG,8OAAC;YAAI,WAAW,CAAC,aAAa,EAAE,aAAa,SAAS,IAAI;sBACvD,cAAA,8OAAC,kIAAQ;gBACN,gBAAgB;gBAChB,UAAU,IAAM,OAAO,QAAQ,CAAC,IAAI,GAAG;;;;;;;;;;;IAInD;IAEA,qBACE,8OAAC;QAAI,WAAW,CAAC,aAAa,EAAE,aAAa,SAAS,IAAI;kBACtD,cAAA,8OAAC,mIAAS;YACN,UAAU;YACV,YAAY;YACZ,aAAa;;;;;;;;;;;AAIzB"}}]
}